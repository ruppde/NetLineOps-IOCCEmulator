var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||typeof Object.defineProperties=='function'?Object.defineProperty:function(b,c,a){a=a;if(b==Array.prototype||b==Object.prototype){return}b[c]=a.value};$jscomp.getGlobal=function(a){return typeof window!='undefined'&&window===a?a:typeof global!='undefined'&&global!=null?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(i,f,j,k){if(!f){return}var a=$jscomp.global;var b=i.split('.');for(var e=0;e<b.length-1;e++){var d=b[e];if(!(d in a)){a[d]={}}a=a[d]}var g=b[b.length-1];var h=a[g];var c=f(h);if(c==h||c==null){return}$jscomp.defineProperty(a,g,{configurable:!0,writable:!0,value:c})};$jscomp.polyfill('Array.prototype.copyWithin',function(a){if(a){return a}var b=function(d,c,b){var e=this.length;d=Number(d);c=Number(c);b=Number(b!=null?b:e);if(d<c){b=Math.min(b,e);while(c<b){if(c in this){this[d++]=this[c++]}else {delete this[d++];c++}}}else {b=Math.min(b,e+c-d);d+=b-c;while(b>c){if(--b in this){this[--d]=this[b]}else {delete this[d]}}}return this};return b},'es6','es3');$jscomp.SYMBOL_PREFIX='jscomp_symbol_';$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};if(!$jscomp.global['Symbol']){$jscomp.global['Symbol']=$jscomp.Symbol}};$jscomp.Symbol=function(){var a=0;function Symbol(b){return $jscomp.SYMBOL_PREFIX+(b||'')+a++}return Symbol}();$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global['Symbol'].iterator;if(!a){a=$jscomp.global['Symbol'].iterator=$jscomp.global['Symbol']('iterator')}if(typeof Array.prototype[a]!='function'){$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}})}$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){if(b<a.length){return {done:!1,value:a[b++]}}else {return {done:!0}}})};$jscomp.iteratorPrototype=function(b){$jscomp.initSymbolIterator();var a={next:b};a[$jscomp.global['Symbol'].iterator]=function(){return this};return a};$jscomp.iteratorFromArray=function(a,d){$jscomp.initSymbolIterator();if(a instanceof String){a=a+''}var c=0;var b={next:function(){if(c<a.length){var e=c++;return {value:d(e,a[e]),done:!1}}b.next=function(){return {done:!0,value:void 0}};return b.next()}};b[Symbol.iterator]=function(){return b};return b};$jscomp.polyfill('Array.prototype.entries',function(a){if(a){return a}var b=function(){return $jscomp.iteratorFromArray(this,function(b,c){return [b,c]})};return b},'es6','es3');$jscomp.polyfill('Array.prototype.fill',function(a){if(a){return a}var b=function(f,c,b){var d=this.length||0;if(c<0){c=Math.max(0,d+c)}if(b==null||b>d){b=d}b=Number(b);if(b<0){b=Math.max(0,d+b)}for(var e=Number(c||0);e<b;e++){this[e]=f}return this};return b},'es6','es3');$jscomp.findInternal=function(a,d,e){if(a instanceof String){a=String(a)}var f=a.length;for(var b=0;b<f;b++){var c=a[b];if(d.call(e,c,b,a)){return {i:b,v:c}}}return {i:-1,v:void 0}};$jscomp.polyfill('Array.prototype.find',function(a){if(a){return a}var b=function(c,b){return $jscomp.findInternal(this,c,b).v};return b},'es6','es3');$jscomp.polyfill('Array.prototype.findIndex',function(a){if(a){return a}var b=function(c,b){return $jscomp.findInternal(this,c,b).i};return b},'es6','es3');$jscomp.polyfill('Array.from',function(a){if(a){return a}var b=function(b,c,g){$jscomp.initSymbolIterator();c=c!=null?c:function(d){return d};var e=[];var f=b[Symbol.iterator];if(typeof f=='function'){b=f.call(b);var h;var j=0;while(!(h=b.next()).done){e.push(c.call(g,h.value,j++))}}else {var i=b.length;for(var d=0;d<i;d++){e.push(c.call(g,b[d],d))}}return e};return b},'es6','es3');$jscomp.polyfill('Object.is',function(a){if(a){return a}var b=function(b,c){if(b===c){return b!==0||1/b===1/c}else {return b!==b&&c!==c}};return b},'es6','es3');$jscomp.polyfill('Array.prototype.includes',function(a){if(a){return a}var b=function(d,g){var c=this;if(c instanceof String){c=String(c)}var f=c.length;var b=g||0;if(b<0){b=Math.max(b+f,0)}for(;b<f;b++){var e=c[b];if(e===d||Object.is(e,d)){return !0}}return !1};return b},'es7','es3');$jscomp.polyfill('Array.prototype.keys',function(a){if(a){return a}var b=function(){return $jscomp.iteratorFromArray(this,function(b){return b})};return b},'es6','es3');$jscomp.polyfill('Array.of',function(a){if(a){return a}var b=function(b){return Array.from(arguments)};return b},'es6','es3');$jscomp.polyfill('Array.prototype.values',function(a){if(a){return a}var b=function(){return $jscomp.iteratorFromArray(this,function(c,b){return b})};return b},'es8','es3');$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();var b=a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.polyfill('Promise',function(c){if(c&&!$jscomp.FORCE_POLYFILL_PROMISE){return c}function AsyncExecutor(){this.batch_=null}AsyncExecutor.prototype.asyncExecute=function(a){if(this.batch_==null){this.batch_=[];this.asyncExecuteBatch_()}this.batch_.push(a);return this};AsyncExecutor.prototype.asyncExecuteBatch_=function(){var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})};var e=$jscomp.global['setTimeout'];AsyncExecutor.prototype.asyncExecuteFunction=function(a){e(a,0)};AsyncExecutor.prototype.executeBatch_=function(){while(this.batch_&&this.batch_.length){var b=this.batch_;this.batch_=[];for(var a=0;a<b.length;++a){var d=b[a];b[a]=null;try{d()}catch(f){this.asyncThrow_(f)}}}this.batch_=null};AsyncExecutor.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a})};var b={PENDING:0,FULFILLED:1,REJECTED:2};var a=function(d){this.state_=b.PENDING;this.result_=undefined;this.onSettledCallbacks_=[];var a=this.createResolveAndReject_();try{d(a.resolve,a.reject)}catch(f){a.reject(f)}};a.prototype.createResolveAndReject_=function(){var b=this;var a=!1;function firstCallWins(d){return function(e){if(!a){a=!0;d.call(b,e)}}}return {resolve:firstCallWins(this.resolveTo_),reject:firstCallWins(this.reject_)}};a.prototype.resolveTo_=function(b){if(b===this){this.reject_(new TypeError('A Promise cannot resolve to itself'))}else {if(b instanceof a){this.settleSameAsPromise_(b)}else {if(isObject(b)){this.resolveToNonPromiseObj_(b)}else {this.fulfill_(b)}}}};a.prototype.resolveToNonPromiseObj_=function(b){var a=undefined;try{a=b.then}catch(f){this.reject_(f);return}if(typeof a=='function'){this.settleSameAsThenable_(a,b)}else {this.fulfill_(b)}};function isObject(a){switch(typeof a){case 'object':return a!=null;case 'function':return !0;default:return !1;}}a.prototype.reject_=function(a){this.settle_(b.REJECTED,a)};a.prototype.fulfill_=function(a){this.settle_(b.FULFILLED,a)};a.prototype.settle_=function(d,a){if(this.state_!=b.PENDING){throw new Error('Cannot settle('+d+', '+a+'): Promise already settled in state'+this.state_)}this.state_=d;this.result_=a;this.executeOnSettledCallbacks_()};a.prototype.executeOnSettledCallbacks_=function(){if(this.onSettledCallbacks_!=null){for(var a=0;a<this.onSettledCallbacks_.length;++a){d.asyncExecute(this.onSettledCallbacks_[a])}this.onSettledCallbacks_=null}};var d=new AsyncExecutor();a.prototype.settleSameAsPromise_=function(b){var a=this.createResolveAndReject_();b.callWhenSettled_(a.resolve,a.reject)};a.prototype.settleSameAsThenable_=function(b,d){var a=this.createResolveAndReject_();try{b.call(d,a.resolve,a.reject)}catch(f){a.reject(f)}};a.prototype.then=function(f,g){var b;var d;var e=new a(function(a,e){b=a;d=e});function createCallback(a,e){if(typeof a=='function'){return function(h){try{b(a(h))}catch(i){d(i)}}}else {return e}}this.callWhenSettled_(createCallback(f,b),createCallback(g,d));return e};a.prototype['catch']=function(a){return this.then(undefined,a)};a.prototype.callWhenSettled_=function(e,f){var a=this;function callback(){switch(a.state_){case b.FULFILLED:e(a.result_);break;case b.REJECTED:f(a.result_);break;default:throw new Error('Unexpected state: '+a.state_);}}if(this.onSettledCallbacks_==null){d.asyncExecute(callback)}else {this.onSettledCallbacks_.push(callback)}};function resolvingPromise(b){if(b instanceof a){return b}else {return new a(function(a,d){a(b)})}}a['resolve']=resolvingPromise;a['reject']=function(b){return new a(function(d,a){a(b)})};a['race']=function(b){return new a(function(e,f){var d=$jscomp.makeIterator(b);for(var a=d.next();!a.done;a=d.next()){resolvingPromise(a.value).callWhenSettled_(e,f)}})};a['all']=function(e){var d=$jscomp.makeIterator(e);var b=d.next();if(b.done){return resolvingPromise([])}else {return new a(function(g,h){var a=[];var f=0;function onFulfilled(b){return function(d){a[b]=d;f--;if(f==0){g(a)}}}do{a.push(undefined);f++;resolvingPromise(b.value).callWhenSettled_(onFulfilled(a.length-1),h);b=d.next()}while(!b.done)})}};return a},'es6','es3');$jscomp.polyfill('Promise.prototype.finally',function(a){if(a){return a}var b=function(b){return this.then(function(d){var c=Promise.resolve(b());return c.then(function(){return d})},function(d){var c=Promise.resolve(b());return c.then(function(){throw d})})};return b},'es9','es3');$jscomp.underscoreProtoCanBeSet=function(){var b={a:!0};var a={};try{a.__proto__=b;return a.a}catch(c){}return !1};$jscomp.setPrototypeOf=typeof Object.setPrototypeOf=='function'?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(a,b){a.__proto__=b;if(a.__proto__!==b){throw new TypeError(a+' is not extensible')}return a}:null;$jscomp.generator={};$jscomp.generator.ensureIteratorResultIsObject_=function(a){if(a instanceof Object){return}throw new TypeError('Iterator result '+a+' is not an object')};$jscomp.generator.Context=function(){this.isRunning_=!1;this.yieldAllIterator_=null;this.yieldResult=undefined;this.nextAddress=1;this.catchAddress_=0;this.finallyAddress_=0;this.abruptCompletion_=null;this.finallyContexts_=null};$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_){throw new TypeError('Generator is already running')}this.isRunning_=!0};$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1};$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_};$jscomp.generator.Context.prototype.next_=function(a){this.yieldResult=a};$jscomp.generator.Context.prototype.throw_=function(a){this.abruptCompletion_={exception:a,isException:!0};this.jumpToErrorHandler_()};$jscomp.generator.Context.prototype['return']=function(a){this.abruptCompletion_={'return':a};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(a){this.abruptCompletion_={jumpTo:a};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.yield=function(b,a){this.nextAddress=a;return {value:b}};$jscomp.generator.Context.prototype.yieldAll=function(d,b){var c=$jscomp.makeIterator(d);var a=c.next();$jscomp.generator.ensureIteratorResultIsObject_(a);if(a.done){this.yieldResult=a.value;this.nextAddress=b;return}this.yieldAllIterator_=c;return this.yield(a.value,b)};$jscomp.generator.Context.prototype.jumpTo=function(a){this.nextAddress=a};$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0};$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(b,a){this.catchAddress_=b;if(a!=undefined){this.finallyAddress_=a}};$jscomp.generator.Context.prototype.setFinallyBlock=function(a){this.catchAddress_=0;this.finallyAddress_=a||0};$jscomp.generator.Context.prototype.leaveTryBlock=function(b,a){this.nextAddress=b;this.catchAddress_=a||0};$jscomp.generator.Context.prototype.enterCatchBlock=function(a){this.catchAddress_=a||0;var b=this.abruptCompletion_.exception;this.abruptCompletion_=null;return b};$jscomp.generator.Context.prototype.enterFinallyBlock=function(c,b,a){if(!a){this.finallyContexts_=[this.abruptCompletion_]}else {this.finallyContexts_[a]=this.abruptCompletion_}this.catchAddress_=c||0;this.finallyAddress_=b||0};$jscomp.generator.Context.prototype.leaveFinallyBlock=function(d,c){var b=this.finallyContexts_.splice(c||0)[0];var a=this.abruptCompletion_=this.abruptCompletion_||b;if(a){if(a.isException){return this.jumpToErrorHandler_()}if(a.jumpTo!=undefined&&this.finallyAddress_<a.jumpTo){this.nextAddress=a.jumpTo;this.abruptCompletion_=null}else {this.nextAddress=this.finallyAddress_}}else {this.nextAddress=d}};$jscomp.generator.Context.prototype.forIn=function(a){return new $jscomp.generator.Context.PropertyIterator(a)};$jscomp.generator.Context.PropertyIterator=function(a){this.object_=a;this.properties_=[];for(var b in a){this.properties_.push(b)}this.properties_.reverse()};$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){while(this.properties_.length>0){var a=this.properties_.pop();if(a in this.object_){return a}}return null};$jscomp.generator.Engine_=function(a){this.context_=new $jscomp.generator.Context();this.program_=a};$jscomp.generator.Engine_.prototype.next_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_){return this.yieldAllStep_(this.context_.yieldAllIterator_.next,a,this.context_.next_)}this.context_.next_(a);return this.nextStep_()};$jscomp.generator.Engine_.prototype.return_=function(b){this.context_.start_();var a=this.context_.yieldAllIterator_;if(a){var c='return' in a?a['return']:function(a){return {value:a,done:!0}};return this.yieldAllStep_(c,b,this.context_['return'])}this.context_['return'](b);return this.nextStep_()};$jscomp.generator.Engine_.prototype.throw_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_){return this.yieldAllStep_(this.context_.yieldAllIterator_['throw'],a,this.context_.next_)}this.context_.throw_(a);return this.nextStep_()};$jscomp.generator.Engine_.prototype.yieldAllStep_=function(d,e,c){try{var a=d.call(this.context_.yieldAllIterator_,e);$jscomp.generator.ensureIteratorResultIsObject_(a);if(!a.done){this.context_.stop_();return a}var b=a.value}catch(f){this.context_.yieldAllIterator_=null;this.context_.throw_(f);return this.nextStep_()}this.context_.yieldAllIterator_=null;c.call(this.context_,b);return this.nextStep_()};$jscomp.generator.Engine_.prototype.nextStep_=function(){while(this.context_.nextAddress){try{var b=this.program_(this.context_);if(b){this.context_.stop_();return {value:b.value,done:!1}}}catch(c){this.context_.yieldResult=undefined;this.context_.throw_(c)}}this.context_.stop_();if(this.context_.abruptCompletion_){var a=this.context_.abruptCompletion_;this.context_.abruptCompletion_=null;if(a.isException){throw a.exception}return {value:a['return'],done:!0}}return {value:undefined,done:!0}};$jscomp.generator.Generator_=function(a){this.next=function(b){return a.next_(b)};this['throw']=function(b){return a.throw_(b)};this['return']=function(b){return a.return_(b)};$jscomp.initSymbolIterator();this[Symbol.iterator]=function(){return this}};$jscomp.generator.createGenerator=function(b,c){var a=new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(c));if($jscomp.setPrototypeOf){$jscomp.setPrototypeOf(a,b.prototype)}return a};$jscomp.asyncExecutePromiseGenerator=function(a){function passValueToGenerator(b){return a.next(b)}function passErrorToGenerator(b){return a['throw'](b)}return new Promise(function(b,c){function handleGeneratorRecord(d){if(d.done){b(d.value)}else {Promise.resolve(d.value).then(passValueToGenerator,passErrorToGenerator).then(handleGeneratorRecord,c)}}handleGeneratorRecord(a.next())})};$jscomp.asyncExecutePromiseGeneratorFunction=function(a){return $jscomp.asyncExecutePromiseGenerator(a())};$jscomp.asyncExecutePromiseGeneratorProgram=function(a){return $jscomp.asyncExecutePromiseGenerator(new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(a)))};$jscomp.checkEs6ConformanceViaProxy=function(){try{var a={};var b=Object.create(new $jscomp.global['Proxy'](a,{'get':function(d,e,c){return d==a&&e=='q'&&c==b}}));return b['q']===!0}catch(c){return !1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.owns=function(b,a){return Object.prototype.hasOwnProperty.call(b,a)};$jscomp.polyfill('WeakMap',function(c){function isConformant(){if(!c||!Object.seal){return !1}try{var b=Object.seal({});var d=Object.seal({});var a=new c([[b,2],[d,3]]);if(a.get(b)!=2||a.get(d)!=3){return !1}a['delete'](b);a.set(d,4);return !a.has(b)&&a.get(d)==4}catch(e){return !1}}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(c&&$jscomp.ES6_CONFORMANCE){return c}}else {if(isConformant()){return c}}var a='$jscomp_hidden_'+Math.random();function insert(b){if(!$jscomp.owns(b,a)){var d={};$jscomp.defineProperty(b,a,{value:d})}}function patch(a){var b=Object[a];if(b){Object[a]=function(d){insert(d);return b(d)}}}patch('freeze');patch('preventExtensions');patch('seal');var d=0;var b=function(a){this.id_=(d+=Math.random()+1).toString();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();var f=$jscomp.makeIterator(a);var b;while(!(b=f.next()).done){var e=b.value;this.set(e[0],e[1])}}};b.prototype.set=function(b,d){insert(b);if(!$jscomp.owns(b,a)){throw new Error('WeakMap key fail: '+b)}b[a][this.id_]=d;return this};b.prototype.get=function(b){return $jscomp.owns(b,a)?b[a][this.id_]:undefined};b.prototype.has=function(b){return $jscomp.owns(b,a)&&$jscomp.owns(b[a],this.id_)};b.prototype['delete']=function(b){if(!$jscomp.owns(b,a)||!$jscomp.owns(b[a],this.id_)){return !1}return delete b[a][this.id_]};return b},'es6','es3');$jscomp.MapEntry=function(){this.previous;this.next;this.head;this.key;this.value};$jscomp.polyfill('Map',function(b){function isConformant(){if($jscomp.ASSUME_NO_NATIVE_MAP||!b||typeof b!='function'||!b.prototype.entries||typeof Object.seal!='function'){return !1}try{b=b;var e=Object.seal({x:4});var c=new b($jscomp.makeIterator([[e,'s']]));if(c.get(e)!='s'||c.size!=1||c.get({x:4})||c.set({x:4},'t')!=c||c.size!=2){return !1}var d=c.entries();var a=d.next();if(a.done||a.value[0]!=e||a.value[1]!='s'){return !1}a=d.next();if(a.done||a.value[0].x!=4||a.value[1]!='t'||!d.next().done){return !1}return !0}catch(i){return !1}}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(b&&$jscomp.ES6_CONFORMANCE){return b}}else {if(isConformant()){return b}}$jscomp.initSymbol();$jscomp.initSymbolIterator();var e=new WeakMap();var a=function(a){this.data_={};this.head_=f();this.size=0;if(a){var e=$jscomp.makeIterator(a);var c;while(!(c=e.next()).done){var d=c.value;this.set(d[0],d[1])}}};a.prototype.set=function(d,e){d=d===0?0:d;var a=c(this,d);if(!a.list){a.list=this.data_[a.id]=[]}if(!a.entry){a.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:d,value:e};a.list.push(a.entry);this.head_.previous.next=a.entry;this.head_.previous=a.entry;this.size++}else {a.entry.value=e}return this};a.prototype['delete']=function(d){var a=c(this,d);if(a.entry&&a.list){a.list.splice(a.index,1);if(!a.list.length){delete this.data_[a.id]}a.entry.previous.next=a.entry.next;a.entry.next.previous=a.entry.previous;a.entry.head=null;this.size--;return !0}return !1};a.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=f();this.size=0};a.prototype.has=function(a){return !!c(this,a).entry};a.prototype.get=function(d){var a=c(this,d).entry;return a&&a.value};a.prototype.entries=function(){return d(this,function(a){return [a.key,a.value]})};a.prototype.keys=function(){return d(this,function(a){return a.key})};a.prototype.values=function(){return d(this,function(a){return a.value})};a.prototype.forEach=function(e,d){var f=this.entries();var c;while(!(c=f.next()).done){var a=c.value;e.call(d,a[1],a[0],this)}};a.prototype[Symbol.iterator]=a.prototype.entries;var c=function(g,e){var f=h(e);var a=g.data_[f];if(a&&$jscomp.owns(g.data_,f)){for(var d=0;d<a.length;d++){var c=a[d];if(e!==e&&c.key!==c.key||e===c.key){return {id:f,list:a,index:d,entry:c}}}}return {id:f,list:a,index:-1,entry:undefined}};var d=function(c,d){var a=c.head_;return $jscomp.iteratorPrototype(function(){if(a){while(a.head!=c.head_){a=a.previous}while(a.next!=a.head){a=a.next;return {done:!1,value:d(a)}}a=null}return {done:!0,value:void 0}})};var f=function(){var a={};a.previous=a.next=a.head=a;return a};var g=0;var h=function(a){var c=a&&typeof a;if(c=='object'||c=='function'){a=a;if(!e.has(a)){var d=''+ ++g;e.set(a,d);return d}return e.get(a)}return 'p_'+a};return a},'es6','es3');$jscomp.polyfill('Math.acosh',function(a){if(a){return a}var b=function(b){b=Number(b);return Math.log(b+Math.sqrt(b*b-1))};return b},'es6','es3');$jscomp.polyfill('Math.asinh',function(a){if(a){return a}var b=function(b){b=Number(b);if(b===0){return b}var c=Math.log(Math.abs(b)+Math.sqrt(b*b+1));return b<0?-c:c};return b},'es6','es3');$jscomp.polyfill('Math.log1p',function(a){if(a){return a}var b=function(b){b=Number(b);if(b<0.25&&b>-0.25){var f=b;var g=1;var c=b;var d=0;var e=1;while(d!=c){f*=b;e*=-1;c=(d=c)+e*f/++g}return c}return Math.log(1+b)};return b},'es6','es3');$jscomp.polyfill('Math.atanh',function(b){if(b){return b}var a=Math.log1p;var c=function(c){c=Number(c);return (a(c)-a(-c))/2};return c},'es6','es3');$jscomp.polyfill('Math.cbrt',function(a){if(a){return a}var b=function(b){if(b===0){return b}b=Number(b);var c=Math.pow(Math.abs(b),1/3);return b<0?-c:c};return b},'es6','es3');$jscomp.polyfill('Math.clz32',function(a){if(a){return a}var b=function(b){b=Number(b)>>>0;if(b===0){return 32}var c=0;if((b&4.29490176E9)===0){b<<=16;c+=16}if((b&4.27819008E9)===0){b<<=8;c+=8}if((b&4.02653184E9)===0){b<<=4;c+=4}if((b&3.221225472E9)===0){b<<=2;c+=2}if((b&2.147483648E9)===0){c++}return c};return b},'es6','es3');$jscomp.polyfill('Math.cosh',function(a){if(a){return a}var b=Math.exp;var c=function(c){c=Number(c);return (b(c)+b(-c))/2};return c},'es6','es3');$jscomp.polyfill('Math.expm1',function(a){if(a){return a}var b=function(b){b=Number(b);if(b<0.25&&b>-0.25){var e=b;var f=1;var c=b;var d=0;while(d!=c){e*=b/++f;c=(d=c)+e}return c}return Math.exp(b)-1};return b},'es6','es3');$jscomp.polyfill('Math.hypot',function(a){if(a){return a}var b=function(d,e,h){d=Number(d);e=Number(e);var b,g,f;var c=Math.max(Math.abs(d),Math.abs(e));for(b=2;b<arguments.length;b++){c=Math.max(c,Math.abs(arguments[b]))}if(c>1.0E100||c<1.0E-100){if(!c){return c}d=d/c;e=e/c;f=d*d+e*e;for(b=2;b<arguments.length;b++){g=Number(arguments[b])/c;f+=g*g}return Math.sqrt(f)*c}else {f=d*d+e*e;for(b=2;b<arguments.length;b++){g=Number(arguments[b]);f+=g*g}return Math.sqrt(f)}};return b},'es6','es3');$jscomp.polyfill('Math.imul',function(a){if(a){return a}var b=function(b,c){b=Number(b);c=Number(c);var f=b>>>16&65535;var d=b&65535;var g=c>>>16&65535;var e=c&65535;var h=f*e+d*g<<16>>>0;return d*e+h|0};return b},'es6','es3');$jscomp.polyfill('Math.log10',function(a){if(a){return a}var b=function(b){return Math.log(b)/Math.LN10};return b},'es6','es3');$jscomp.polyfill('Math.log2',function(a){if(a){return a}var b=function(b){return Math.log(b)/Math.LN2};return b},'es6','es3');$jscomp.polyfill('Math.sign',function(a){if(a){return a}var b=function(b){b=Number(b);return b===0||isNaN(b)?b:b>0?1:-1};return b},'es6','es3');$jscomp.polyfill('Math.sinh',function(a){if(a){return a}var b=Math.exp;var c=function(c){c=Number(c);if(c===0){return c}return (b(c)-b(-c))/2};return c},'es6','es3');$jscomp.polyfill('Math.tanh',function(a){if(a){return a}var b=function(b){b=Number(b);if(b===0){return b}var c=Math.exp(-2*Math.abs(b));var d=(1-c)/(1+c);return b<0?-d:d};return b},'es6','es3');$jscomp.polyfill('Math.trunc',function(a){if(a){return a}var b=function(b){b=Number(b);if(isNaN(b)||b===Infinity||b===-Infinity||b===0){return b}var c=Math.floor(Math.abs(b));return b<0?-c:c};return b},'es6','es3');$jscomp.polyfill('Number.EPSILON',function(a){return Math.pow(2,-52)},'es6','es3');$jscomp.polyfill('Number.MAX_SAFE_INTEGER',function(){return 9.007199254740991E15},'es6','es3');$jscomp.polyfill('Number.MIN_SAFE_INTEGER',function(){return -9.007199254740991E15},'es6','es3');$jscomp.polyfill('Number.isFinite',function(a){if(a){return a}var b=function(b){if(typeof b!=='number'){return !1}return !isNaN(b)&&b!==Infinity&&b!==-Infinity};return b},'es6','es3');$jscomp.polyfill('Number.isInteger',function(a){if(a){return a}var b=function(b){if(!Number.isFinite(b)){return !1}return b===Math.floor(b)};return b},'es6','es3');$jscomp.polyfill('Number.isNaN',function(a){if(a){return a}var b=function(b){return typeof b==='number'&&isNaN(b)};return b},'es6','es3');$jscomp.polyfill('Number.isSafeInteger',function(a){if(a){return a}var b=function(b){return Number.isInteger(b)&&Math.abs(b)<=Number.MAX_SAFE_INTEGER};return b},'es6','es3');$jscomp.polyfill('Number.parseFloat',function(a){return a||parseFloat},'es6','es3');$jscomp.polyfill('Number.parseInt',function(a){return a||parseInt},'es6','es3');$jscomp.assign=typeof Object.assign=='function'?Object.assign:function(d,e){for(var c=1;c<arguments.length;c++){var a=arguments[c];if(!a){continue}for(var b in a){if($jscomp.owns(a,b)){d[b]=a[b]}}}return d};$jscomp.polyfill('Object.assign',function(a){return a||$jscomp.assign},'es6','es3');$jscomp.polyfill('Object.entries',function(a){if(a){return a}var b=function(c){var d=[];for(var b in c){if($jscomp.owns(c,b)){d.push([b,c[b]])}}return d};return b},'es8','es3');$jscomp.polyfill('Object.getOwnPropertySymbols',function(a){if(a){return a}return function(){return []}},'es6','es5');$jscomp.polyfill('Reflect.ownKeys',function(b){if(b){return b}var a='jscomp_symbol_';function isSymbol(c){return c.substring(0,a.length)==a}var c=function(e){var f=[];var c=Object.getOwnPropertyNames(e);var d=Object.getOwnPropertySymbols(e);for(var a=0;a<c.length;a++){(isSymbol(c[a])?d:f).push(c[a])}return f.concat(d)};return c},'es6','es5');$jscomp.polyfill('Object.getOwnPropertyDescriptors',function(a){if(a){return a}var b=function(e){var d={};var c=Reflect.ownKeys(e);for(var b=0;b<c.length;b++){d[c[b]]=Object.getOwnPropertyDescriptor(e,c[b])}return d};return b},'es8','es5');$jscomp.polyfill('Object.setPrototypeOf',function(a){return a||$jscomp.setPrototypeOf},'es6','es5');$jscomp.polyfill('Object.values',function(a){if(a){return a}var b=function(b){var c=[];for(var d in b){if($jscomp.owns(b,d)){c.push(b[d])}}return c};return b},'es8','es3');$jscomp.polyfill('Reflect.apply',function(a){if(a){return a}var c=Function.prototype.apply;var b=function(e,d,b){return c.call(e,d,b)};return b},'es6','es3');$jscomp.objectCreate=$jscomp.ASSUME_ES5||typeof Object.create=='function'?Object.create:function(b){var a=function(){};a.prototype=b;return new a()};$jscomp.construct=function(){function reflectConstructWorks(){function Base(){}function Derived(){}new Base();Reflect.construct(Base,[],Derived);return new Base() instanceof Base}if(typeof Reflect!='undefined'&&Reflect.construct){if(reflectConstructWorks()){return Reflect.construct}var b=Reflect.construct;var a=function(e,d,a){var c=b(e,d);if(a){Reflect.setPrototypeOf(c,a.prototype)}return c};return a}function construct(b,d,a){if(a===undefined){a=b}var f=a.prototype||Object.prototype;var c=$jscomp.objectCreate(f);var e=Function.prototype.apply;var g=e.call(b,c,d);return g||c}return construct}();$jscomp.polyfill('Reflect.construct',function(a){return $jscomp.construct},'es6','es3');$jscomp.polyfill('Reflect.defineProperty',function(a){if(a){return a}var b=function(e,d,c){try{Object.defineProperty(e,d,c);var b=Object.getOwnPropertyDescriptor(e,d);if(!b){return !1}return b.configurable===(c.configurable||!1)&&b.enumerable===(c.enumerable||!1)&&('value' in b?b.value===c.value&&b.writable===(c.writable||!1):b.get===c.get&&b.set===c.set)}catch(f){return !1}};return b},'es6','es5');$jscomp.polyfill('Reflect.deleteProperty',function(a){if(a){return a}var b=function(c,b){if(!$jscomp.owns(c,b)){return !0}try{return delete c[b]}catch(d){return !1}};return b},'es6','es3');$jscomp.polyfill('Reflect.getOwnPropertyDescriptor',function(a){return a||Object.getOwnPropertyDescriptor},'es6','es5');$jscomp.polyfill('Reflect.getPrototypeOf',function(a){return a||Object.getPrototypeOf},'es6','es5');$jscomp.findDescriptor=function(d,c){var a=d;while(a){var b=Reflect.getOwnPropertyDescriptor(a,c);if(b){return b}a=Reflect.getPrototypeOf(a)}return undefined};$jscomp.polyfill('Reflect.get',function(a){if(a){return a}var b=function(d,c,e){if(arguments.length<=2){return d[c]}var b=$jscomp.findDescriptor(d,c);if(b){return b.get?b.get.call(e):b.value}return undefined};return b},'es6','es5');$jscomp.polyfill('Reflect.has',function(a){if(a){return a}var b=function(c,b){return b in c};return b},'es6','es3');$jscomp.polyfill('Reflect.isExtensible',function(a){if(a){return a}if($jscomp.ASSUME_ES5||typeof Object.isExtensible=='function'){return Object.isExtensible}return function(){return !0}},'es6','es3');$jscomp.polyfill('Reflect.preventExtensions',function(a){if(a){return a}if(!($jscomp.ASSUME_ES5||typeof Object.preventExtensions=='function')){return function(){return !1}}var b=function(b){Object.preventExtensions(b);return !Object.isExtensible(b)};return b},'es6','es3');$jscomp.polyfill('Reflect.set',function(a){if(a){return a}var b=function(b,d,e,f){var c=$jscomp.findDescriptor(b,d);if(!c){if(Reflect.isExtensible(b)){b[d]=e;return !0}return !1}if(c.set){c.set.call(arguments.length>3?f:b,e);return !0}else {if(c.writable&&!Object.isFrozen(b)){b[d]=e;return !0}}return !1};return b},'es6','es5');$jscomp.polyfill('Reflect.setPrototypeOf',function(a){if(a){return a}else {if($jscomp.setPrototypeOf){var b=$jscomp.setPrototypeOf;var c=function(c,d){try{b(c,d);return !0}catch(e){return !1}};return c}else {return null}}},'es6','es5');$jscomp.polyfill('Set',function(b){function isConformant(){if($jscomp.ASSUME_NO_NATIVE_SET||!b||typeof b!='function'||!b.prototype.entries||typeof Object.seal!='function'){return !1}try{b=b;var d=Object.seal({x:4});var c=new b($jscomp.makeIterator([d]));if(!c.has(d)||c.size!=1||c.add(d)!=c||c.size!=1||c.add({x:4})!=c||c.size!=2){return !1}var e=c.entries();var a=e.next();if(a.done||a.value[0]!=d||a.value[1]!=d){return !1}a=e.next();if(a.done||a.value[0]==d||a.value[0].x!=4||a.value[1]!=a.value[0]){return !1}return e.next().done}catch(f){return !1}}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(b&&$jscomp.ES6_CONFORMANCE){return b}}else {if(isConformant()){return b}}$jscomp.initSymbol();$jscomp.initSymbolIterator();var a=function(a){this.map_=new Map();if(a){var e=$jscomp.makeIterator(a);var c;while(!(c=e.next()).done){var d=c.value;this.add(d)}}this.size=this.map_.size};a.prototype.add=function(a){a=a===0?0:a;this.map_.set(a,a);this.size=this.map_.size;return this};a.prototype['delete']=function(c){var a=this.map_['delete'](c);this.size=this.map_.size;return a};a.prototype.clear=function(){this.map_.clear();this.size=0};a.prototype.has=function(a){return this.map_.has(a)};a.prototype.entries=function(){return this.map_.entries()};a.prototype.values=function(){return this.map_.values()};a.prototype.keys=a.prototype.values;a.prototype[Symbol.iterator]=a.prototype.values;a.prototype.forEach=function(c,a){var d=this;this.map_.forEach(function(e){return c.call(a,e,e,d)})};return a},'es6','es3');$jscomp.checkStringArgs=function(a,c,b){if(a==null){throw new TypeError("The 'this' value for String.prototype."+b+' must not be null or undefined')}if(c instanceof RegExp){throw new TypeError('First argument to String.prototype.'+b+' must not be a regular expression')}return a+''};$jscomp.polyfill('String.prototype.codePointAt',function(a){if(a){return a}var b=function(b){var e=$jscomp.checkStringArgs(this,null,'codePointAt');var f=e.length;b=Number(b)||0;if(!(b>=0&&b<f)){return void 0}b=b|0;var c=e.charCodeAt(b);if(c<55296||c>56319||b+1===f){return c}var d=e.charCodeAt(b+1);if(d<56320||d>57343){return c}return (c-55296)*1024+d+9216};return b},'es6','es3');$jscomp.polyfill('String.prototype.endsWith',function(a){if(a){return a}var b=function(b,c){var d=$jscomp.checkStringArgs(this,b,'endsWith');b=b+'';if(c===void 0){c=d.length}var f=Math.max(0,Math.min(c|0,d.length));var e=b.length;while(e>0&&f>0){if(d[--f]!=b[--e]){return !1}}return e<=0};return b},'es6','es3');$jscomp.polyfill('String.fromCodePoint',function(a){if(a){return a}var b=function(e){var c='';for(var d=0;d<arguments.length;d++){var b=Number(arguments[d]);if(b<0||b>1114111||b!==Math.floor(b)){throw new RangeError('invalid_code_point '+b)}if(b<=65535){c+=String.fromCharCode(b)}else {b-=65536;c+=String.fromCharCode(b>>>10&1023|55296);c+=String.fromCharCode(b&1023|56320)}}return c};return b},'es6','es3');$jscomp.polyfill('String.prototype.includes',function(a){if(a){return a}var b=function(b,c){var d=$jscomp.checkStringArgs(this,b,'includes');return d.indexOf(b,c||0)!==-1};return b},'es6','es3');$jscomp.polyfill('String.prototype.repeat',function(a){if(a){return a}var b=function(b){var c=$jscomp.checkStringArgs(this,null,'repeat');if(b<0||b>1342177279){throw new RangeError('Invalid count value')}b=b|0;var d='';while(b){if(b&1){d+=c}if(b>>>=1){c+=c}}return d};return b},'es6','es3');$jscomp.stringPadding=function(c,a){var b=c!==undefined?String(c):' ';if(!(a>0)||!b){return ''}var d=Math.ceil(a/b.length);return b.repeat(d).substring(0,a)};$jscomp.polyfill('String.prototype.padEnd',function(a){if(a){return a}var b=function(d,c){var b=$jscomp.checkStringArgs(this,null,'padStart');var e=d-b.length;return b+$jscomp.stringPadding(c,e)};return b},'es8','es3');$jscomp.polyfill('String.prototype.padStart',function(a){if(a){return a}var b=function(d,c){var b=$jscomp.checkStringArgs(this,null,'padStart');var e=d-b.length;return $jscomp.stringPadding(c,e)+b};return b},'es8','es3');$jscomp.polyfill('String.prototype.startsWith',function(a){if(a){return a}var b=function(b,g){var c=$jscomp.checkStringArgs(this,b,'startsWith');b=b+'';var h=c.length;var e=b.length;var f=Math.max(0,Math.min(g|0,c.length));var d=0;while(d<e&&f<h){if(c[f++]!=b[d++]){return !1}}return d>=e};return b},'es6','es3');$jscomp.arrayFromIterator=function(c){var b;var a=[];while(!(b=c.next()).done){a.push(b.value)}return a};$jscomp.arrayFromIterable=function(a){if(a instanceof Array){return a}else {return $jscomp.arrayFromIterator($jscomp.makeIterator(a))}};$jscomp.inherits=function(a,b){a.prototype=$jscomp.objectCreate(b.prototype);a.prototype.constructor=a;if($jscomp.setPrototypeOf){var e=$jscomp.setPrototypeOf;e(a,b)}else {for(var c in b){if(c=='prototype'){continue}if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);if(d){Object.defineProperty(a,c,d)}}else {a[c]=b[c]}}}a.superClass_=b.prototype};$jscomp.polyfill('WeakSet',function(a){function isConformant(){if(!a||!Object.seal){return !1}try{var c=Object.seal({});var d=Object.seal({});var b=new a([c]);if(!b.has(c)||b.has(d)){return !1}b['delete'](c);b.add(d);return !b.has(c)&&b.has(d)}catch(e){return !1}}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE){return a}}else {if(isConformant()){return a}}var b=function(b){this.map_=new WeakMap();if(b){$jscomp.initSymbol();$jscomp.initSymbolIterator();var e=$jscomp.makeIterator(b);var c;while(!(c=e.next()).done){var d=c.value;this.add(d)}}};b.prototype.add=function(b){this.map_.set(b,!0);return this};b.prototype.has=function(b){return this.map_.has(b)};b.prototype['delete']=function(b){return this.map_['delete'](b)};return b},'es6','es3');try{if(Array.prototype.values.toString().indexOf('[native code]')==-1){delete Array.prototype.values}}catch(a){}Ext.define('WuisLogin.util.VTypes',{override:'Ext.form.field.VTypes',wuisPassword:function(c,e){var d=e.next('#pwStrength');var a=!0;var b='';if(!c){a=!1}if(a&&c.length<8){b='Invalid password. Must be min. 8 characters!';a=!1}if(a&&!/^(?=.*[a-z].*[a-z].*[a-z])/.test(c)){b='Must contain at least 3 lower case characters!';a=!1}if(a&&!/^(?=.*[A-Z])/.test(c)){b='Must contain at least 1 upper case character!';a=!1}if(a&&!/^(?=.*[0-9])/.test(c)){b='Must contain at least 1 digit!';a=!1}if(a&&!/^(?=.*[!@#\$%\^&\*])(?=.{8,})/.test(c)){b='Must contain at least 1 symbol (!@#$%^&*)!';a=!1}this.wuisPasswordText=b;if(d){if(!a){d.setValue(b)}else {d.setValue('Valid password.')}}return a},wuisPasswordText:'Invalid password. Must be min. 8 characters and must contain at least 1 upper case character, 3 lower case character,1 digit or digit character in the middle and 1 symbol character!'});Ext.define('WuisLogin.Common',{singleton:!0,tenantKeyLS:'NeoSecurity-Tenant',applications:{usrMgmt:{name:'usrMgmt',requiredRight:'readIdentity'},ioccSecurity:{name:'iocc-security-webui',requiredRight:'View_SecurityAdminApplication'},ioccSecurityAuthorization:{name:'iocc-security-authorization',requiredRight:'editRight'},ioccSecurityIdentity:{name:'iocc-security-identity',requiredRight:'editIdentity'},briefing:{name:'Briefing',requiredRight:'View_myBriefingApplication'},opsTimesSquare:{name:'NetLineOps',requiredRight:'View_TimesSquareApplication'},crewLinkRoster:{name:'CrewLink',requiredRight:'View_CrewLinkRosterApplication'},crewLinkAdmin:{name:'CrewLink',requiredRight:'View_CrewLinkNoCrewApplication'},crewLinkCrewInformation:{name:'CrewLink',requiredRight:'View_CrewLinkCrewApplication'},crewLinkCheckIn:{name:'CrewLink',requiredRight:'View_CrewLinkCrewApplication'}},messageMap:{'iocc.sec.internal.config.load.error':'An unexpected error has occurred while loading the security configuration! Please try again later or contact the system administrator!','iocc.sec.unexpected.exception':'An unexpected server error has occurred while processing your request! Please try again later or contact the system administrator!','iocc.sec.authorization.failed':'Authorization failed! Please try again later or contact the system administrator!','iocc.sec.authentication.failed':'Authentication failed: username or password invalid!','iocc.sec.authentication.failed.user.not.activated':'Authentication failed: user not activated!','iocc.sec.authentication.failed.incorrect.pw':'Authentication failed: incorrect password','iocc.sec.authentication.validation.failed':'The certificate has expired!','iocc.sec.authentication.certificate.nullorempty':'You have logged out from the application or the login session is expired.<br/>You can close this window or reload the application to sign in again!','iocc.sec.authentication.certificate.decodingerror':'The certificate could not be decoded!','iocc.sec.authentication.certificate.expired':'The login session has been expired.<br/>Please reauthenticate yourself with your username and password!','iocc.sec.authentication.certificate.notyetvalid':'The current Date or the specified Date is before the notBefore date/time in the Certificate validity period!','iocc.sec.authentication.certificate.invalidkey':'Certificate public key not found!','iocc.sec.authentication.certificate.exception':'Certificate validation failed!','iocc.sec.authentication.certificate.nosuchalgorithm':'Certificate validation failed!','iocc.sec.authentication.certificate.nosuchprovider':'Certificate validation failed!','iocc.sec.authentication.certificate.wrongsignature':'Generic Signature exception occurred!','iocc.sec.authentication.notfound':'Authentication failed: user not found!','iocc.sec.authentication.publickey.notfound':'Certificate public key not found!','iocc.sec.connection.error':'Connection to security service could not be created!','iocc.sec.identity.password.weak':'New password too weak, password not changed!','iocc.sec.identity.password.incorrect':'Provided credentials are not correct, password not changed!','iocc.sec.identity.password.notallowed':'Password change not allowed!','iocc.sec.identity.password.exception':'Could not cahnge password. An error happened!','iocc.sec.internal.session.expired.close':'The login session has been expired.<br/>You must close this window and restart the application to sign in again!','iocc.sec.internal.session.expired.reload':'The login session has been expired.<br/>You must close this window or reload the application to sign in again!','iocc.sec.internal.session.expired.reauthenticate':'The login session has been expired.<br/>Please reauthenticate yourself with your username and password!','iocc.sec.internal.logged.out':'You have logged out from the application!<br/>You can close this window or reload the application to sign in again!','iocc.sec.internal.warning.identity.changed':'Application must be reloaded, because login credentials has been changed since last login!','iocc.sec.internal.button.reload':'Reload Application','iocc.sec.internal.button.close':'Close Application','iocc.sec.internal.error.load.config':'Unable to retrieve security configuration from server!<br/>Application can continue, but some features might not work properly.<br/>If the problem persist, please call system administrator!<br/>','iocc.sec.internal.logged.out.or.session.expired':'You have logged out from the application or the login session is expired!<br/>You can close this window or reload the application to sign in again!','iocc.sec.internal.error.no.message':'Either your user name or password is invalid.<br/>Please retry the operation or click the "forgot password to reset your password.','iocc.sec.internal.authentication.not.found':'You are not authorized to use this application!<br/>You have to log in with a different credential, or contact the system administrator!','iocc.sec.mailsending.error':'Unable to complete the operation as server is not able to send e-mails now.<br/>If the problem persist, please call system administrator!<br/>'},hasApplicationAccess:function(g){var f=this;var b=WuisLogin.Security.applications;var d=WuisLogin.Security.rights;var e=f.applications;var c=e[g];var a;if(!c||!b){return !1}a=c.name;if(b[a]===!0&&Ext.isObject(d)){return d[a+'.'+c.requiredRight]===!0}return b[a]&&b[a][c.requiredRight]},checkCompatibleRights:function(b){var c=WuisLogin.Security.rights;var a=!0;Ext.iterate(b,function(e,d){if(d&&!c[e]){a=!1;return !1}});return a},loadTenant:function(){return window.localStorage&&window.localStorage.getItem(this.tenantKeyLS)||null},saveTenant:function(a){var b=this;if(!window.localStorage){return !1}if(!a){window.localStorage.removeItem(b.tenantKeyLS);return null}if(!Ext.isString(a)){return !1}window.localStorage.setItem(b.tenantKeyLS,a);return a}});Ext.define('WuisLogin.Security',{singleton:!0,data:null,identity:null,rights:null,applications:null,config:null,tenants:null,authorize:function(c,a){var b=this;if(!c){Ext.log.error('WuisLogin.Security.authorize() method requires url parameter to be set!')}Ext.Ajax.request({url:c,method:'GET',disableCaching:!0,success:function(h,i){var d=Ext.decode(h.responseText,!0);var e=null;var g=null;var f=null;if(d&&d.success&&d.result){d=d.result;if(d.aggregatedRights){g={};f={};Ext.each(d.aggregatedRights,function(d){var b=d.application;g[(b?b+'.':'')+d.name]=d.active;if(b){f[b]=f[b]||d.active}})}if(d.identity){e={};Ext.apply(e,{id:d.identity.id,name:d.identity.name,type:d.identity.type,roles:{},attributes:{}});if(d.ownRoles){Ext.each(d.ownRoles,function(b){e.roles[b.name]=!0})}if(d.identity.attributes){Ext.each(d.identity.attributes,function(b){e.attributes[b.attribute.name]=b.value})}}b.data=d;b.identity=e;b.rights=g;b.applications=f;if(a&&a.success){a.success.call(a.scope||b,h,i,d)}}else {if(a&&a.failure){a.failure.call(a.scope||b,h,i,d)}}},failure:function(d,f){var e=Ext.decode(d.responseText,!0);if(a&&a.failure){a.failure.call(a.scope||b,d,f,e)}}})},neoSecurityAuthorize:function(c,a){var b=this;if(!c){Ext.log.error('WuisLogin.Security.authorize() method requires url parameter to be set!')}Ext.Ajax.request({url:c,method:'GET',disableCaching:!0,success:function(g,h){var d=Ext.decode(g.responseText,!0);var i=null;var f=null;var e=null;if(!d||!d.tenant||!d.userName){if(a&&a.failure){a.failure.call(a.scope||b,g,h,d)}return}b.data=d;if(d.rights){f={};e={};Ext.each(d.rights,function(i){var b=i.module;var d=i.name;e[b]=e[b]||{};e[b][d]=!0;f[d]=f[d]||{};f[d][b]=!0})}i={name:d.userName||null,attributes:d.attributes||{},tenant:d.tenant||null};b.identity=i;b.rights=f;b.applications=e;if(a&&a.success){a.success.call(a.scope||b,g,h,d)}},failure:function(d,f){var e=Ext.decode(d.responseText,!0);if(a&&a.failure){a.failure.call(a.scope||b,d,f,e)}}})},authenticate:function(c,a){var b=this;if(!c){Ext.log.error('WuisLogin.Security.authenticate() method requires at least url parameter to be set!')}Ext.Ajax.request({url:c,method:'GET',disableCaching:!0,success:function(e,f){var d=Ext.decode(e.responseText,!0);if(d&&d.success){if(a&&a.success){a.success.call(a.scope||b,e,f,d)}}else {if(a&&a.failure){a.failure.call(a.scope||b,e,f,d)}}},failure:function(d,f){var e=Ext.decode(d.responseText,!0);if(a&&a.failure){a.failure.call(a.scope||b,d,f,e)}}})},authenticateWithPost:function(c,a){var b=this;if(!c){Ext.log.error('WuisLogin.Security.authenticateWithPost() method requires at least url parameter to be set!')}Ext.Ajax.request({url:c,method:'POST',disableCaching:!0,headers:{password:a.password},success:function(e,f){var d=Ext.decode(e.responseText);if(d&&d.success){if(a&&a.success){a.success.call(a.scope||b,e,f,d)}}else {if(a&&a.failure){a.failure.call(a.scope||b,e,f,d)}}},failure:function(d,f){var e=Ext.decode(d.responseText);if(a&&a.failure){a.failure.call(a.scope||b,d,f,e)}}})},neoSecurityAuthenticate:function(c,a){var b=this;if(!c){Ext.log.error('WuisLogin.Security.authenticate() method requires at least url parameter to be set!')}Ext.Ajax.request({url:c,method:'POST',jsonData:Ext.encode(a.credentials),success:function(e,f){var d=Ext.decode(e.responseText,!0);if(d&&d.success){if(a&&a.success){a.success.call(a.scope||b,e,f,d)}}else {if(a&&a.failure){a.failure.call(a.scope||b,e,f,d)}}},failure:function(d,f){var e=Ext.decode(d.responseText,!0);if(a&&a.failure){a.failure.call(a.scope||b,d,f,e)}}})},logout:function(b,a){var c=this;a=a||{};if(Ext.isString(b)){a.url=b;a.method='GET'}else {if(Ext.isObject(b)){a=Ext.apply(Ext.apply({},b),a)}}if(!a.url){Ext.log.error('WuisLogin.Security.logout() method requires at least url parameter to be set!')}Ext.Ajax.request({url:a.url,method:a.method||'GET',headers:{'Content-Type':'application/json'},success:function(e,f){var d=Ext.decode(e.responseText,!0)||null;if(d&&d.success){if(a&&a.success){a.success.call(a.scope||c,e,f,d)}}else {if(a&&a.failure){a.failure.call(a.scope||c,e,f,d)}}c.resetAuthorizationData()},failure:function(d,f){var e=Ext.decode(d.responseText,!0);if(a&&a.failure){a.failure.call(a.scope||c,d,f,e)}}})},validate:function(c,a){var b=this;if(!c){Ext.log.error('WuisLogin.Security.validate() method requires url parameter to be set!')}a=a||{};Ext.log.info('Validating session...');Ext.Ajax.request({url:c,method:'GET',disableCaching:!0,success:function(d,f){var e=Ext.decode(d.responseText,!0);Ext.log.info('Session validation was successful.');if(a.success){a.success.call(a.scope||b,d,f,e)}},failure:function(d,f){var e=Ext.decode(d.responseText,!0);Ext.log.warn('Session validation failed with error code '+d.status);if(a.failure){a.failure.call(a.scope||b,d,f,e)}}})},renewCertificate:function(c,a){var b=this;if(!c){Ext.log.error('WuisLogin.Security.renewCertificate() method requires url parameter to be set!')}a=a||{};Ext.log.info('Renewing certificate...');Ext.Ajax.request({url:c,method:'GET',disableCaching:!0,success:function(d,f){var e=Ext.decode(d.responseText,!0);Ext.log.info('Certificate renewal was successful.');if(a.success){a.success.call(a.scope||b,d,f,e)}},failure:function(d,f){var e=Ext.decode(d.responseText,!0);Ext.log.warn('Certificate renewal failed with error code '+d.status);if(a.failure){a.failure.call(a.scope||b,d,f,e)}}})},loadConfig:function(c,a){var b=this;if(!c){Ext.log.error('WuisLogin.Security.loadConfig() method requires url parameter to be set!')}a=a||{};Ext.Ajax.request({url:c,method:'GET',disableCaching:!0,success:function(e,f){var d=Ext.decode(e.responseText,!0);if(!Ext.isObject(d)){if(a&&a.failure){a.failure.call(a.scope||b,e,f,d)}return}b.config=d;if(a&&a.success){a.success.call(a.scope||b,e,f,d)}},failure:function(d,f){var e=Ext.decode(d.responseText,!0);if(a&&a.failure){a.failure.call(a.scope||b,d,f,e)}}})},resetAuthorizationData:function(){var a=this;a.data=null;a.identity=null;a.applications=null;a.rights=null;a.tenants=null},loadTenants:function(c,a){var b=this;if(!c){Ext.log.error('WuisLogin.Security.loadTenants() method requires url parameter to be set!')}a=a||{};Ext.Ajax.request({url:c,method:'GET',disableCaching:!0,headers:{'Content-Type':'application/json','Accept':'application/json'},success:function(e,f){var d=Ext.decode(e.responseText,!0);var g=[];if(!d||!Ext.isArray(d)){if(a&&a.failure){a.failure.call(a.scope||b,e,f,d)}return}Ext.each(d,function(b){g.push({name:b})});b.tenants=g;if(a&&a.success){a.success.call(a.scope||b,e,f,d)}},failure:function(d,f){var e=Ext.decode(d.responseText,!0);if(a&&a.failure){a.failure.call(a.scope||b,d,f,e)}}})},hasRight:function(a,c){var b=a.split('.');if(b.length===2){a=b[0];c=b[1]}return this.applications&&this.applications[a]&&this.applications[a][c]},getUrlFromConfig:function(e,b,f){var c=this;var h=Ext.String.uncapitalize(e)+'Url';var g=Ext.String.uncapitalize(e)+'Method';var a=c.config&&c.config[h]||null;var d=c.config&&c.config[g]||'GET';b=b||'';if(a&&Ext.isString(a)){if(a.indexOf('http')===-1){a=b+a}return {url:a,method:d}}return f?{url:b+f,method:d}:null}});Ext.define('WuisLogin.controller.Login',{extend:'Ext.app.Controller',handleAjaxException:!0,handleForbiddenAsUnauthorized:!1,showPasswordChange:!0,passwordChangeWidget:'WuisLoginPasswordChange',passwordChangeViewConfig:null,showForgottenPassword:!1,forgottenPasswordWidget:null,forgottenPasswordViewConfig:null,loginWidget:'WuisLogin',loginViewConfig:null,loginService:null,passwordChangeService:null,forgottenPasswordService:null,init:function(){var a=this;if(a.handleAjaxException){Ext.Ajax.on('requestexception',a.onAjaxRequestException,a)}a.on({login:a.onLogin,passwordchangeclick:a.onPasswordChangeClick,validatepassword:a.onValidatePassword,passwordchange:a.onPasswordChange,passwordchangecancel:a.onCancelPasswordChange,forgottenpasswordclick:a.onForgottenPasswordClick,forgottenpasswordchange:a.onForgottenPasswordChange,forgottenpasswordcancel:a.onCancelForgottenPassword,scope:a})},checkCertificateValidity:function(){},getLoginWin:function(){return Ext.ComponentQuery.query(this.loginWidget)[0]},getPasswordChangeWin:function(){return Ext.ComponentQuery.query(this.passwordChangeWidget)[0]},getForgottenPasswordWin:function(){return Ext.ComponentQuery.query(this.forgottenPasswordWidget)[0]},showLoginWindow:function(b){var c=this;var a=c.getLoginWin();var d;var e;b=Ext.apply(Ext.apply({showForgottenPassword:c.showForgottenPassword,showPasswordChange:c.showPasswordChange},c.loginViewConfig),b);if(!a){a=Ext.widget(c.loginWidget,Ext.apply(b,{eventController:c,showPasswordChange:b.showPasswordChange&&!!c.passwordChangeWidget,showForgottenPassword:b.showForgottenPassword&&!!c.forgottenPasswordWidget},b));if(a.parentContainer){a.parentContainer.add(a)}else {a.show()}}else {if(a.isHidden()){a.show()}}d=a.getUserField();e=a.getPasswordField();d.setValue(b.userName||'');d.setReadOnly(b.userNameReadOnly||!1);e.setValue('');(d.readOnly?e:d).focus(!0)},hasToBeReload:function(){var a=this;var b=a.loginWidget;if(a.passwordChangeWidget){b=b+(','+a.passwordChangeWidget)}if(a.forgottenPasswordWidget){b=b+(','+a.forgottenPasswordWidget)}return !Ext.ComponentQuery.query(b).length},onAjaxRequestException:function(c,a){var b=this;if(a.status===401&&b.hasToBeReload(c,a)){b.reloadApplication()}},reloadApplication:function(){location.href=location.href.replace(/#.*/,'')},checkUnauthenticated:function(a){return a&&(a.status===401||this.handleForbiddenAsUnauthorized&&a.status===403)||!1},onPasswordChangeClick:function(b,a){this.showPasswordChangeWindow(b,a)},showPasswordChangeWindow:function(b,c){var d=this;var a=Ext.widget(d.passwordChangeWidget,Ext.apply({eventController:d},d.passwordChangeViewConfig));var f=a&&a.getUserField();var e=a&&a.getOldPasswordField();if(b&&c===!0){c=Ext.isFunction(b.getForm)&&b.getForm().getValue()||null}if(f){f.setValue(c&&c.user||'')}if(e){e.setValue(c&&c.password||'')}if(b){if(b.parentContainer){b.parentContainer.remove(b)}else {b.destroy()}}if(a.parentContainer){a.parentContainer.add(a)}else {a.show()}},onForgottenPasswordClick:function(b,e){var c=this;var a=Ext.widget(c.forgottenPasswordWidget,Ext.apply({eventController:c},c.forgottenPasswordViewConfig));var d=a.getUserField();if(d){d.setValue(e&&e.user||'')}if(b){if(b.parentContainer){b.parentContainer.remove(b)}else {b.destroy()}}if(a.parentContainer){a.parentContainer.add(a)}else {a.show()}},onValidatePassword:function(c,a){var b=this;var d=Ext.isObject(a)?a.newPassword:a;if(!b.passwordValidatorService){Ext.log.error('[WuisLogin] Please, set passwordValidatorService property or implement the onValidatePassword method!');return}if(c.lastValidatedPassword===d){return}c.lastValidatedPassword=d;c.passwordErrors='Checking password strength...';c.getForm().isValid();if(!Ext.isObject(a)){a={newPassword:a}}b.passwordValidatorService(a,b.validatePasswordCallback,b)},validatePasswordCallback:function(e){var f=this;var a=f.getPasswordChangeWin();var h=a&&a.getPasswordField().getValue();var c=a&&a.getPwStrengthField();var g=a.getErrorMsgBox();var b=e&&e.success&&e.result;var d;if(!a){return}if(b&&h===a.getPasswordField().getValue()){c.removeCls('pw-ok');c.removeCls('pw-error');c.removeCls('pw-warn');if(Ext.isEmpty(b.texts)){c.addCls('pw-ok');a.passwordErrors=null;g.update('')}else {c.addCls(b.passed?'pw-warn':'pw-error');d=Ext.isArray(b.texts)?b.texts:[b.texts||''];d=d.map(f.translateValidationError.bind(f)).map(Ext.htmlEncode).join('<br>');a.passwordErrors=b.passed?'':d;g.update(d)}}else {c.addCls('pw-error');a.passwordErrors='Password check failed!'}a.getForm().isValid()},translateValidationError:function(a){return a},onLogin:function(b,c){var a=this;if(a.loginService){b.setLoading('Login...');a.loginService(c,a.loginCallback,a)}else {Ext.log.error('[WuisLogin] Please, set loginService property or implement the onLogin method!')}},loginCallback:function(a){var c=this;var b=c.getLoginWin();if(b){b.setLoading(!1)}c[a&&a.success?'onSuccessLogin':'onFailureLogin'](a)},onSuccessLogin:function(){this.closeLoginWindow()},onFailureLogin:function(){var d=this;var b=d.getLoginWin();var a=b.getUserField();var c=b.getPasswordField();Ext.Msg.alert('Error','Wrong login name or password!',function(){(a.readOnly?c:a).focus(!0)})},closeLoginWindow:function(){var a=this.getLoginWin();if(a){if(a.parentContainer){a.parentContainer.remove(a)}else {a.destroy()}}},onCancelPasswordChange:function(a,b){var d=this;var c=b.user;if(a.parentContainer){a.parentContainer.remove(a)}else {a.destroy()}d.showLoginWindow({userName:c})},onCancelForgottenPassword:function(){var b=this;var a=b.getForgottenPasswordWin();var c=a.down('#user').getValue();if(a.parentContainer){a.parentContainer.remove(a)}else {a.destroy()}b.showLoginWindow({userName:c})},onPasswordChange:function(c,b){var a=this;if(!a.passwordChangeService){Ext.log.error('[WuisLogin] Please, set the passwordChangeService property or implement the onPasswordChange method!');return}a.passwordChangeService({newPassword:b.password1,currentPassword:b.oldPassword,userName:b.user},a.passwordChangeCallback,a)},passwordChangeCallback:function(a){var c=this;var b=c.getPasswordChangeWin();if(a&&a.success){c.onCancelPasswordChange(b,b.down('form').getValues());return}Ext.Msg.alert('Error',a&&a.result||'Error on service calling!')},onForgottenPasswordChange:function(c,b){var a=this;if(!a.forgottenPasswordService){Ext.log.error('[WuisLogin] Please, set the forgottenPasswordService property or implement the onForgottenPasswordChange method!');return}a.forgottenPasswordService({userName:b.user},a.forgottenPasswordCallback,a)},forgottenPasswordCallback:function(a){var c=this;var b=c.getForgottenPasswordWin();if(a&&a.success){c.onCancelForgottenPassword(b,b.down('form').getValues());return}Ext.Msg.alert('Error',a&&a.result||'Error on service calling!')}});Ext.define('WuisLogin.controller.LoginEx',{extend:'WuisLogin.controller.Login',titleMap:{ERROR:'Error in Operation',WARNING:'Warning',INFO:'Information'},messageMap:null,errorState:null,restPrefix:'/rest',applicationId:null,checkCertificateOnFocus:!1,allowInactivityControl:!1,userInteractionOccured:!1,checkInactivityTask:null,checkInactivityInterval:30,propertiesConfigUrl:'resources/config/properties.json',propertiesConfig:null,autoLoadSecurityConfig:!0,allowSaml2Auth:!1,suppressSaml2Hash:'nosaml2',actionMap:{certificateNotFound:['CLOSE','iocc.sec.internal.button.close'],invalidCertificate:'REVALIDATE',fatalError:'CLOSE',certificateExpired:'LOGOUT',sessionExpired:['RELOAD','iocc.sec.internal.button.reload'],sessionExpiredLogout:['CLOSE','iocc.sec.internal.button.close'],logout:'NOTIFY/CLOSE',initError:['NOTIFY/CLOSE','iocc.sec.internal.button.close']},ssoLogoutTimeoutInterval:30000,loggingOut:!1,init:function(){var a=this;a.handleAjaxException=!1;if(!a.iconMap){a.iconMap={ERROR:Ext.Msg.ERROR,WARNING:Ext.Msg.WARNING,INFO:Ext.Msg.INFO}}WuisLogin.controller.Login.prototype.init.call(this);if(!a.messageMap){Ext.log.warn('Application messages not set in messagesMap: only `WuisLogin.Common.messageMap` messages will be translated!')}a.messageMap=Ext.applyIf(a.messageMap||{},WuisLogin.Common.messageMap);a.on('serviceError',a.handleServiceError,a);if(a.checkCertificateOnFocus){window.onfocus=a.checkCertificateValidity.bind(a)}if(!a.loadProperties()&&a.autoLoadSecurityConfig){a.loadSecurityConfig()}},handleInitError:function(){var c=this,a=window.location,d=a.hash||'',b=Ext.Object.fromQueryString(d.substr(1));if(c.isSaml2Allowed()&&b&&+b.errorCode===102){a.href=a.href.split('#')[0]+'#';c.logout({forced:!0,logoutActionKey:'initError',notifyMessageKey:b.messageKey||'iocc.sec.internal.authentication.not.found'});return !0}return !1},loadProperties:function(b){var a=this;b=b||a.propertiesConfigUrl;if(!b){return !1}Ext.log.info('Loading application properties config...');Ext.Ajax.request({url:b,method:'GET',disableCaching:!0,success:function(d,e){var c=Ext.decode(d.responseText,!0);a.propertiesConfig=c;if(Ext.isObject(c.applications)){Ext.apply(WuisLogin.Common.applications,c.applications)}else {Ext.log.warn('Unable to get application configuration from properties.json! Using the default applications / requiredRight config!')}if(a.fireEvent('propertiesloaded',c,!0,d,e)===!1){return}if(a.autoLoadSecurityConfig){a.loadSecurityConfig()}},failure:function(c,d){var e=Ext.decode(c.responseText,!0);Ext.log.warn('Unable to load properties.json ('+d.url+')! It can be a network/service error or even the file is not bundled with the application. Using the default applications / requiredRight config (status: '+(c.status||'N/A')+')!');if(a.fireEvent('propertiesloaded',e,!1,c,d)===!1){return}if(a.autoLoadSecurityConfig){a.loadSecurityConfig()}}});return !0},loadSecurityConfig:function(){var a=this;WuisLogin.Security.loadConfig(a.restPrefix+'config',{success:function(b,c){var d=Ext.decode(b.responseText,!0);if(a.handleInitError()){return}if(a.fireEvent('securityconfigloaded',d,!0,b,c)===!1){return}a.startInactivityControl()},failure:function(b,c){var d=Ext.decode(b.responseText,!0);Ext.log.warn('Unable to load security configuration ('+c.url+') - application can continue, but with reduced functionality only!');if(a.handleInitError()){return}if(a.fireEvent('securityconfigloaded',d,!1,b,c)===!1){return}a.startInactivityControl()}})},onForgottenPasswordChange:function(c,b){var a=this;Ext.Ajax.request({url:a.restPrefix+'identity/resetpassword/'+encodeURIComponent(b.user),method:'GET',disableCaching:!0,serviceName:'Reset Password',headers:{'Content-Type':'application/json','Accept':'application/json'},success:a.successResetPassword.bind(a),failure:function(d,e){a.fireEvent('serviceError',d,e,null,a.onCancelForgottenPassword,a)},scope:a})},successResetPassword:function(b,d){var a=this,c=b&&Ext.decode(b.responseText,!0);if(!c.success){a.fireEvent('serviceError',b,d,c,a.onCancelForgottenPassword,a);return}Ext.Msg.alert('Password Reset','Please check your email for the activation link!',function(){a.onCancelForgottenPassword()})},checkActivation:function(){var c=this,e=document.location.href.split('?')[1],a=e&&Ext.Object.fromQueryString(e)||null,d=a&&a.token,b=a&&a.user;if(d&&b){Ext.Ajax.request({url:c.restPrefix+'activation/check/'+encodeURIComponent(b)+'?token='+encodeURIComponent(d),method:'GET',disableCaching:!0,headers:{'Content-Type':'application/json','Accept':'application/json'},success:function(a,d){c.onSuccessCheckActivation(a,d,b)},failure:function(a,b){c.fireEvent('serviceError',a,b)}});return !0}return !1},onSuccessCheckActivation:function(f,h,i){var a=this,c=Ext.decode(f.responseText,!0),b=c&&c.result||'UNKNOWN',g,d,e;if(!c.success){a.fireEvent('serviceError',f,h,c,a.showLoginWindow,a);return}if(b==='VALID'){g=a.passwordChangeViewConfig&&a.passwordChangeViewConfig.parentContainer;e=Ext.widget('WuisLoginPasswordReset',Ext.apply({eventController:a},a.passwordChangeViewConfig));d=e.down('[itemId=user]');if(d&&i){d.setValue(i)}g.add(e);return}if(b==='ALREADYACTIVATED'){Ext.Msg.alert('Information','You have already activated your password! Please login!',a.showLoginWindow,a);return}if(b==='INVALID'){Ext.Msg.alert('Error','This activation link is invalid! Please check the URL or send a new password reset request!',a.showLoginWindow,a);return}if(b==='EXPIRED'){Ext.Msg.alert('Error','This activation link has expired. Please send a new password reset request!',a.showLoginWindow,a);return}if(b==='UNKNOWN'){Ext.Msg.alert('Error','The validity of the activation link cannot be verified, please contact system administrator!',a.showLoginWindow,a);return}a.fireEvent('serviceError',f,h,c,a.showLoginWindow,a)},onPasswordChange:function(f,a){var b=this,e=document.location.href.split('?')[1],c=e&&Ext.Object.fromQueryString(e)||null,d={},g=c&&c.token;d.newPassword=a.password1;Ext.Ajax.request({url:b.restPrefix+'activation/activate/'+encodeURIComponent(a.user)+'?token='+encodeURIComponent(g),method:'POST',disableCaching:!0,jsonData:d,headers:{'Content-Type':'application/json','Accept':'application/json'},success:function(c,d){b.onPasswordChangeSuccess(f,a,c,d)},failure:function(c,d){b.fireEvent('serviceError',c,d,null,function(){b.onCancelPasswordChange(f,a)})}})},onPasswordChangeSuccess:function(f,e,d,g){var a=this,c=Ext.decode(d.responseText,!0),b=c&&c.result||'UNKNOWN',h=document.location.href.split('?')[0];if(!c.success||!b){a.fireEvent('serviceError',d,g,c,function(){a.onCancelPasswordChange(f,e)});return}if(b==='VALID'){Ext.Msg.alert('Password Reset','Successfully reset your password. Please login with your new password!',function(){window.history.pushState({},'',h);a.onCancelPasswordChange(f,e)});return}if(b==='ALREADYACTIVATED'){Ext.Msg.alert('Information','You have already activated your password! Please login!',a.showLoginWindow,a);return}if(b==='INVALID'){Ext.Msg.alert('Error','This activation link is invalid! Please check the URL or send a new password reset request!',a.showLoginWindow,a);return}if(b==='EXPIRED'){Ext.Msg.alert('Error','This activation link has expired. Please send a new password reset request!',a.showLoginWindow,a);return}if(b==='UNKNOWN'){Ext.Msg.alert('Error','The validity of the activation link cannot be verified, please contact system administrator!',a.showLoginWindow,a);return}a.fireEvent('serviceError',d,g,c,function(){a.onCancelPasswordChange(f,e)})},onPasswordChangeFailure:function(b,a){var c=this;Ext.Msg.alert('Error','Please try again later or contact the system administrator.',function(){c.onCancelPasswordChange(b,a)})},doAuthorization:function(b){var a=this;WuisLogin.Security.authorize(a.restPrefix+'authorization',{success:a.onAuthorizationSuccess,failure:function(d,c){console.log('doAuthorization: FAILURE!');c.afterLogin=b===!0;a.onAuthorizationFailure(d,c)},scope:a})},checkCertificateValidity:function(){this.validateSession()},onAuthorizationSuccess:function(){console.log('onAuthorizationSuccess...');var a=this,b=a.errorState;if(b){if(!WuisLogin.Common.checkCompatibleRights(b.rights)){a.reloadApplication()}if(a.handleServiceErrorComplete()){return !1}}if(a.applicationId&&!WuisLogin.Common.hasApplicationAccess(a.applicationId)){a.resetAuthorizationData();Ext.Msg.alert('Authorization Error','You are not authorized to access this application!<br/>Please contact your system administrator or try log in with a different credential.',function(){a.showLoginWindow()});return !1}a.fireEvent('userauthorized');return !0},isSaml2Allowed:function(){var b=this,e=window.location.hash||'',a=b.suppressSaml2Hash,c=WuisLogin.Security.config&&WuisLogin.Security.config.authUrl,d=WuisLogin.Security.config&&WuisLogin.Security.config.useSso;return b.allowSaml2Auth&&d&&c&&(!a||e.toLowerCase().indexOf('#'+a)<0)},redirectToAuthenticationUrl:function(){var c=this,a=WuisLogin.Security.config&&WuisLogin.Security.config.authUrl,b=window.location.origin||window.location.protocol+'//'+window.location.hostname+(window.location.port?':'+window.location.port:'');if(c.isSaml2Allowed()){a+='?'+Ext.Object.toQueryString({backUrl:b+window.location.pathname});Ext.log.info('Session is unauthenticated, but SAML2/SSO authentication is enabled: redirecting to `'+a+'` ...');window.location.href=a;return !0}return !1},onAuthorizationFailure:function(c,b,e){var a=this,f=b&&b.afterLogin,d=a.isSaml2Allowed();if(a.checkUnauthenticated(c)){if(a.handleSessionExpired(c,b,e)){return}Ext.log.info('Session is unauthenticated, and SAML2/SSO authentication is '+(a.isSaml2Allowed()?'enabled':'disabled')+': showing login window...');if(!f&&!d){a.showLoginWindow();return}Ext.Msg.show({title:a.titleMap.INFO,icon:Ext.Msg.INFO,msg:a.messageMap['iocc.sec.authorization.failed'],message:a.messageMap['iocc.sec.authorization.failed'],closable:!1,buttons:Ext.Msg.OK,buttonText:{ok:'Ok'},fn:function(){if(d){a.closeApplication()}else {a.showLoginWindow()}}});return}a.fireEvent('serviceError',c,b,e,a.showLoginWindow)},onLogin:function(c,b){var a=this;c.setLoading('Login...');WuisLogin.Security.authenticate(a.restPrefix+'authentication/'+encodeURIComponent(b.user)+'?password='+encodeURIComponent(b.password),{success:a.onSuccessLogin,failure:a.onFailureLogin,scope:a})},onSuccessLogin:function(a,e){var b=this,d=b.getLoginWin(),c=a&&Ext.decode(a.responseText,!0)||null;if(d){d.setLoading(!1)}if(!c||!c.success){b.fireEvent('serviceError',a,e,null);return}WuisLogin.controller.Login.prototype.onSuccessLogin.apply(this,arguments);b.doAuthorization(!0)},onFailureLogin:function(c,d){var b=this,a=b.getLoginWin();if(a){a.setLoading(!1)}b.fireEvent('serviceError',c,d,null)},handleServiceError:function(b,e,d,f,g){var a=this,c;if(a.errorState){Ext.log.warn('Repeated error occurred while processing requests!')}a.errorState={response:b,opts:e,data:d,rights:a.errorState&&a.errorState.rights,identity:WuisLogin.Security.identity,callback:f,scope:g};c=a.processMessages(b,e,d);if(b&&a.checkUnauthenticated(b)){a.showMessages(c,0,function(){if(a.handleSessionExpired(b,e,d)){return}a.handleServiceErrorReauthenticate()});return}a.showMessages(c,0,a.handleServiceErrorComplete,a)},handleServiceErrorReauthenticate:function(){var a=this,d='',c=!1,b=Ext.ComponentQuery.query('WuisLoginPasswordReset')[0];if(WuisLogin.Security.identity){d=a.getLoginUserName();c=!0}if(b){b.destroy()}a.errorState.rights=WuisLogin.Security.rights;a.showLoginWindow({userName:d,userNameReadOnly:c})},handleServiceErrorComplete:function(){var a=this,b=a.errorState&&a.errorState.callback,c=a.errorState&&a.errorState.scope;if(b){b.call(c||a);a.errorState=null;return !0}a.errorState=null;return !1},processMessages:function(e,g,b,i){var c=this,a=[],f=c.messageMap,h,d=g&&g.serviceName&&' - '+g.serviceName||'';if(!e){a.push({icon:Ext.Msg.ERROR,title:'Error in Service'+d,message:f['iocc.sec.unexpected.exception']});return a}if(!b&&e.responseText){try{b=Ext.decode(e.responseText,!0)}catch(j){Ext.log.warn('Unable to decode response text.',j)}}if(b){if(Ext.isString(b)){a.push({icon:Ext.Msg.ERROR,title:c.titleMap.ERROR+d,message:b})}else {if(b.errState&&b.errState.errMessage){a.push({icon:Ext.Msg.ERROR,title:c.titleMap.ERROR+d,message:b.errState.errMessage})}else {if(b.messages){Ext.each(b.messages,function(j){var l=Ext.isString(j)?j:Ext.isObject(f)&&f[j.messageKey]||j.messageKey,k=Ext.isArray(j.params)?j.params:[];if(!l){Ext.iterate(j,function(a,c){if(a!=='params'&&a!=='messageKey'&&a!=='popUpType'&&a!=='severity'){l=c;return !1}})}if(k[0]&&Ext.isNumber(k[0])){h=k[0]}a.push({icon:c.iconMap[j.severity]||Ext.Msg.ERROR,title:(c.titleMap[j.severity]||c.titleMap.ERROR)+d,message:Ext.String.format(l,k.join(', '))||'An unrecongnized error occurred',errorCode:h})})}}}}if(a.length){return a}if(c.checkUnauthenticated(e)){a.push({icon:Ext.Msg.ERROR,title:'Unauthorized Operation'+d,message:f[i?'iocc.sec.internal.logged.out.or.session.expired':'iocc.sec.internal.error.no.message']});return a}a.push({icon:Ext.Msg.ERROR,title:c.titleMap.ERROR+d,message:'An unexpected error (status: '+(e.status||'none')+') occurred while trying to process your request!<br/>Please try again or notify the system administrator if the problem persists!'});return a},showMessages:function(d,b,c,e){b=b||0;var f=this,a=d[b];if(!a){if(c){c.call(e||f)}return}Ext.Msg.show({title:a.title,msg:a.message,message:a.message,icon:a.icon||Ext.Msg.ERROR,buttons:Ext.Msg.OK,closable:!1,fn:function(){f.showMessages(d,b+1,c,e)}})},startInactivityControl:function(){var a=this;if(!a.allowInactivityControl){Ext.log.info('Inactivity control is disabled on client-side.');return !1}if(!a.getCheckInactivityInterval()){Ext.log.info('Inactivity control is disabled on server-side.');return !1}a.resetInactivityCheckTask(!0);Ext.getBody().on({click:a.handleUserInteraction,keypress:a.handleUserInteraction,scope:a});return !0},getCheckInactivityInterval:function(){var b=this,a;if(b.checkInactivityInterval){return b.checkInactivityInterval}a=WuisLogin.Security.config&&WuisLogin.Security.config.certValidity||null;return a?Math.floor(a*60/3):null},resetInactivityCheckTask:function(d){var a=this,b=a.getCheckInactivityInterval(),c=!1;if(a.checkInactivityTask){c=!0;a.checkInactivityTask.stop();a.checkInactivityTask=null}if(!a.allowInactivityControl){d=!1}if(!d||!b||!a.allowInactivityControl){Ext.log.info(c?'User inactivity check is stopped.':'User inactivity check has already stopped.');return}a.checkInactivityTask=Ext.TaskManager.newTask({run:a.checkInactivity,scope:a,interval:b*1000});a.checkInactivityTask.start();Ext.log.info('User inactivity check is '+(c?'restarted ':'started')+' ('+b+' sec).')},checkInactivity:function(){var a=this,b=a.userInteractionOccured;a.userInteractionOccured=!1;a.resetInactivityCheckTask(!0);if(!a.isLoggedIn()){return}if(b){a.renewSession();return}a.validateSession()},validateSession:function(){var a=this,b=a.messageMap;if(!a.isLoggedIn()){return}WuisLogin.Security.validate(a.restPrefix+'authentication/validate',{success:function(e,f,c){var d=c&&c.userName||null;if(!a.isLoggedIn()){return}if(d.toUpperCase()!==a.getLoginUserName().toUpperCase()){a.resetAuthorizationData();Ext.Msg.show({title:a.titleMap.WARNING,icon:a.iconMap.WARNING,msg:b['iocc.sec.internal.warning.identity.changed'],message:b['iocc.sec.internal.warning.identity.changed'],closable:!1,buttons:Ext.Msg.OK,buttonText:{ok:b['iocc.sec.internal.button.reload']},fn:function(){a.reloadApplication()}});return}},failure:function(b,c,d){if(a.checkUnauthenticated(b)){a.handleSessionExpired(b,c,d,!0)}}})},renewSession:function(){var a=this,b=a.messageMap,c=a.getLoginUserName();if(!a.isLoggedIn()){return}if(!c){Ext.log.warn('Unable to start heartbeat: identity name is missing!');return}WuisLogin.Security.renewCertificate(a.restPrefix+'authentication/renew/'+encodeURIComponent(c),{success:function(f,g,d){var e=d&&d.user||null;if(!a.isLoggedIn()){return}if(e.toUpperCase()!==c.toUpperCase()){a.resetAuthorizationData();Ext.Msg.show({title:a.titleMap.WARNING,icon:a.iconMap.WARNING,msg:b['iocc.sec.internal.warning.identity.changed'],message:b['iocc.sec.internal.warning.identity.changed'],closable:!1,buttons:Ext.Msg.OK,buttonText:{ok:b['iocc.sec.internal.button.reload']},fn:function(){a.reloadApplication()}});return}},failure:function(b,c,d){if(a.checkUnauthenticated(b)){a.handleSessionExpired(b,c,d,!0)}}})},isLoggedIn:function(){return this.loggingOut?!1:!!WuisLogin.Security.identity},getLoginUserName:function(){return WuisLogin.Security.identity&&Ext.isString(WuisLogin.Security.identity.name)?WuisLogin.Security.identity.name:null},handleUserInteraction:function(a){var b=this;if(!b.userInteractionOccured){b.userInteractionOccured=!0;Ext.log.info('User interaction occured ('+(a&&a.type||'???')+').')}},logout:function(a){var b=this;a=a||{};if(a.forced!==!0&&!b.isLoggedIn()){return !1}b.loggingOut=!0;Ext.getBody().mask();WuisLogin.Security.logout(Ext.apply(WuisLogin.Security.getUrlFromConfig('logout',b.restPrefix,'logout'),{success:function(d,c,e){Ext.getBody().unmask();b.logoutInIframe(function(){b.loggingOut=!1;if(a.success&&a.success.call(a.scope||b,d,c,e)===!1){return}b.handleLogout(d,c,a,e,!0)})},failure:function(c,d){b.loggingOut=!1;Ext.getBody().unmask();if(a.failure&&a.failure.call(a.scope||b,c,d)===!1){return}b.fireEvent('serviceError',c,a,null)}}));return !0},logoutInIframe:function(b,f){var d=this,e=WuisLogin.Security.config&&WuisLogin.Security.config.useSsoLogoutUrl?WuisLogin.Security.getUrlFromConfig('ssoLogout'):null,c=!1,a;if(d.isSaml2Allowed()&&e&&e.url){Ext.getBody().mask();a=document.createElement('iframe');a.setAttribute('border',0);a.setAttribute('height',0);a.setAttribute('width',0);a.src=e.url;a.onload=function(){Ext.getBody().unmask();if(!c){return}c=!1;if(b){b.call(f||d,!0)}};c=!0;Ext.getBody().dom.appendChild(a);Ext.defer(function(){Ext.getBody().unmask();if(!c){return}c=!1;if(b){b.call(f||d,!1)}},d.ssoLogoutTimeoutInterval);return}if(b){b.call(f||d)}},handleSessionExpired:function(h,l,e,o,f){var a=this,m={100:'certificateNotFound',101:'invalidCertificate',102:'fatalError',103:'certificateExpired'},n=a.messageMap,j=a.actionMap,i='OK',d=[],g,c,k,b;if(o!==!0&&!a.isLoggedIn()){return !1}e=e||Ext.decode(h.responseText,!0);d=a.processMessages(h,l,e,!0);if(d&&d.length){c=d[0].errorCode;g=d[0].message}k=c&&m[c]||'sessionExpired';b=j[k]||j.sessionExpired;if(Ext.isArray(b)){i=n[b[1]]||'OK';b=b[0]}if(a.isSaml2Allowed()&&b==='REAUTHENTICATE'){b='CLOSE'}if(f&&(!c||c===100)){a.handleValidateResponse('RELOAD',!0);return !0}if(!f&&a.fireEvent('sessionexpired',h,l,e,b)===!1){return !0}if(!c||!a.isSaml2Allowed()){if(b==='RELOAD'){a.resetAuthorizationData();a.logoutInIframe(function(){a.reloadApplication()});return !0}if(b==='REAUTHENTICATE'){if(f){a.showLoginWindow()}else {a.resetAuthorizationData();a.logoutInIframe(function(){a.reloadApplication()})}return !0}}if(b!=='LOGOUT'){a.resetAuthorizationData()}else {a.loggingOut=!0}a.logoutInIframe(function(){Ext.Msg.show({title:a.titleMap.INFO,icon:Ext.Msg.INFO,msg:g,message:g,closable:!1,buttons:Ext.Msg.OK,buttonText:{ok:i},fn:function(){a.handleValidateResponse(b)}})});return !0},handleValidateResponse:function(b,c){var a=this;if(b==='CLOSE'){a.closeApplication();return}if(b==='CLOSE/RELOAD'){a.closeApplication();a.reloadApplication();return}if(b==='REVALIDATE'){a.validateSession();return}if(b==='REAUTHENTICATE'||b==='RELOAD'){if(!a.redirectToAuthenticationUrl()){if(c){a.showLoginWindow()}else {a.reloadApplication()}}return}if(b==='LOGOUT'){a.logout({forced:!0,logoutActionKey:'sessionExpiredLogout'});return}},handleLogout:function(f,g,c,d,h){var b=this,a=b.actionMap[c.logoutActionKey||'logout']||b.actionMap.logout,e='OK';if(Ext.isArray(a)){e=b.messageMap[a[1]]||'OK';a=a[0]}d=d||Ext.decode(f.responseText,!0);if(b.fireEvent('logout',f,g,c,d,h,a)===!1){return}Ext.util.Cookies.clear('IOCC-Cert');Ext.util.Cookies.clear('IOCC-Cert-zipped');b.resetAuthorizationData();if(a.indexOf('NOTIFY')!==0&&b.handleDefaultAction(a)){return !1}b.notifyMessage(c.notifyMessageKey||'iocc.sec.internal.logged.out',e,a)},notifyMessage:function(a,d,e){var c=this,b=c.messageMap;Ext.Msg.show({title:c.titleMap.INFO,icon:Ext.Msg.INFO,msg:b[a]||a,message:b[a]||a,closable:!1,buttons:Ext.Msg.OK,buttonText:{ok:b[d]||d},fn:function(){c.handleDefaultAction(e)}})},handleDefaultAction:function(b){var a=this;if(b.indexOf('CLOSE/RELOAD')>=0){a.closeApplication();a.reloadApplication();return !0}if(b.indexOf('RELOAD')>=0){a.reloadApplication();return !0}if(b.indexOf('CLOSE')>=0){a.closeApplication();return !0}return !1},resetAuthorizationData:function(){WuisLogin.Security.resetAuthorizationData()},closeApplication:function(){window.close()}});Ext.cmd.derive('WuisLogin.view.ForgottenPasswordForm',Ext.panel.Panel,{cls:'wuislogin-forgottenpwd',layout:'fit',closable:!1,resizable:!1,constrain:!0,width:300,title:'Forgotten Password - Password Reset',iconCls:'icon-key',frame:!1,bodyBorder:!1,border:!0,hideBorders:!0,buttonTextOk:'Send Password Reset',buttonTextCancel:'Cancel',passwordResetText:'',eventController:null,headerHtml:'<img src="resources/wuis-login/lsy-logo-small.png" style="width:250px;height:30px;margin-top:10px" />',initComponent:function(){var a=this;a.createItems();a.createButtons();Ext.panel.Panel.prototype.initComponent.apply(this,arguments)},createItems:function(){var a=this;a.items={xtype:'form',frame:!1,bodyBorder:!1,border:!1,hideBorders:!0,bodyPadding:15,dockedItems:[{xtype:'box',html:a.headerHtml}],items:[{xtype:'textfield',labelAlign:'top',fieldLabel:'User Name',name:'user',itemId:'user',margin:'0 0 5 0',labelStyle:'margin-bottom:5px',anchor:'100%',allowBlank:!1,listeners:{specialkey:a.onSpecialKey,scope:a}}],listeners:{validitychange:a.onFormValidityChange,scope:a}}},createButtons:function(){var a=this;a.buttons=[{text:a.buttonTextCancel||'Cancel',itemId:'cancelBtn',cls:'id-cancelBtn',handler:a.onCancelClick,scope:a},{text:a.buttonTextOk||'Send reset instructions',itemId:'okBtn',cls:'id-okBtn',disabled:!0,handler:a.onOkClick,scope:a}]},afterRender:function(){Ext.panel.Panel.prototype.afterRender.call(this);this.focus();this.down('[name=user]').focus()},onFormValidityChange:function(b,a){this.down('#okBtn').setDisabled(!a)},onSpecialKey:function(b,a){if(a.getKey()===a.ENTER){this.onOkClick()}},onCancelClick:function(){var a=this;var b=a.down('form');(a.eventController||a).fireEvent('forgottenpasswordcancel',a,b.getValues())},onOkClick:function(){var a=this;var b=a.down('form');if(!b.isValid()){return}a.down('#okBtn').setDisabled(!0);(a.eventController||a).fireEvent('forgottenpasswordchange',a,b.getValues())},getUserField:function(){return this.down('#user')}},0,['WuisLoginForgottenPasswordForm'],['component','box','container','panel','WuisLoginForgottenPasswordForm'],{'component':!0,'box':!0,'container':!0,'panel':!0,'WuisLoginForgottenPasswordForm':!0},['widget.WuisLoginForgottenPasswordForm'],0,[WuisLogin.view,'ForgottenPasswordForm'],0);Ext.define('WuisLogin.view.Login',{extend:'Ext.window.Window',alias:'widget.WuisLogin',component:!0,box:!0,container:!0,panel:!0,window:!0,WuisLogin:!0,cls:'wuislogin-window',layout:'fit',closable:!1,resizable:!1,modal:!0,constrain:!0,width:500,y:140,title:'Login',iconCls:'icon-key',eventController:null,headerHtml:null,initComponent:function(){var a=this;a.createItems();a.createButtons();Ext.window.Window.prototype.initComponent.apply(this,arguments)},createItems:function(){var a=this;var b=[];if(a.headerHtml){b.push({xtype:'box',cls:'login-header',html:a.headerHtml})}if(WuisLogin.Security.tenants){b.push({xtype:'combobox',name:'tenant',labelAlign:'top',fieldLabel:'Airline',emptyText:'Please choose an airline',store:{fields:['name'],data:WuisLogin.Security.tenants},queryMode:'local',displayField:'name',valueField:'name',allowBlank:!1,itemId:'tenant',margin:'0 0 5 280',labelStyle:'margin-bottom:5px',anchor:'100%',value:WuisLogin.Common.loadTenant(),editable:!1})}b.push({xtype:'textfield',labelAlign:'top',fieldLabel:'Login Name',name:'user',itemId:'user',margin:'0 0 5 280',labelStyle:'margin-bottom:5px',anchor:'100%',allowBlank:!1,value:a.userName||'',readOnly:a.userNameReadOnly||!1,listeners:{specialkey:a.onSpecialKey,scope:a}});b.push({xtype:'textfield',labelAlign:'top',fieldLabel:'Password',inputType:'password',name:'password',itemId:'password',margin:'0 0 30 280',labelStyle:'margin-bottom:5px',anchor:'100%',allowBlank:!1,listeners:{specialkey:a.onSpecialKey,scope:a}});if(a.showForgottenPassword){b.push({xtype:'component',autoEl:{tag:'a',href:'#',html:'Forgot your password?'},listeners:{el:{click:a.onForgottenPasswordClick},scope:a}})}a.items={xtype:'form',border:0,bodyPadding:15,items:b,listeners:{validitychange:a.onFormValidityChange,scope:a}}},createButtons:function(){var a=this;var c={text:'Change password',itemId:'changePasswordBtn',cls:'id-changePasswordBtn',hidden:!a.showPasswordChange,handler:a.onPasswordChangeClick,scope:a};var b={text:'Login',iconCls:'icon-key',cls:'id-loginBtn',itemId:'loginBtn',disabled:!0,handler:a.onLoginClick,scope:a};a.buttons=a.loginFirst?[b,c]:[c,b]},afterRender:function(){Ext.window.Window.prototype.afterRender.call(this);this.focus();this.getUserField().focus()},onFormValidityChange:function(b,a){this.down('#loginBtn').setDisabled(!a)},onSpecialKey:function(b,a){if(a.getKey()===a.ENTER){this.onLoginClick()}},onForgottenPasswordClick:function(c){c.preventDefault();var a=this;var b=a.down('form');(a.eventController||a).fireEvent('forgottenpasswordclick',a,b.getValues())},onPasswordChangeClick:function(){var a=this;var b=a.getForm();(a.eventController||a).fireEvent('passwordchangeclick',a,b.getValues())},onLoginClick:function(){var a=this;var b=a.getForm();if(!b.isValid()){return}(a.eventController||a).fireEvent('login',a,b.getValues())},getUserField:function(){return this.getForm().items.get('user')},getPasswordField:function(){return this.getForm().items.get('password')},getForm:function(){return this.items.getAt(0)}});Ext.cmd.derive('WuisLogin.view.LoginForm',Ext.panel.Panel,{cls:'wuislogin-form',layout:'fit',closable:!1,resizable:!1,constrain:!0,width:300,frame:!1,bodyBorder:!1,border:!0,hideBorders:!0,bodyPadding:15,headerHtml:null,eventController:null,initComponent:function(){var a=this;a.createItems();a.createButtons();Ext.panel.Panel.prototype.initComponent.apply(this,arguments)},createItems:function(){var a=this,b=[];if(a.headerHtml){b.push({xtype:'box',html:a.headerHtml})}if(WuisLogin.Security.tenants){b.push({xtype:'combobox',name:'tenant',labelAlign:'top',fieldLabel:'Airline',emptyText:'Please choose an airline',store:{fields:['name'],data:WuisLogin.Security.tenants},queryMode:'local',displayField:'name',valueField:'name',allowBlank:!1,itemId:'tenant',margin:'0 0 5 0',labelStyle:'margin-bottom:5px',anchor:'100%',value:WuisLogin.Common.loadTenant(),editable:!1})}b.push({xtype:'textfield',labelAlign:'top',fieldLabel:'User Name',name:'user',itemId:'user',margin:'0 0 5 0',labelStyle:'margin-bottom:5px',anchor:'100%',allowBlank:!1,value:a.userName||'',readOnly:a.userNameReadOnly||!1,listeners:{specialkey:a.onSpecialKey,scope:a}});b.push({xtype:'textfield',labelAlign:'top',fieldLabel:'Password',inputType:'password',name:'password',itemId:'password',margin:'0 0 30 0',labelStyle:'margin-bottom:5px',anchor:'100%',allowBlank:a.emptyPasswordEnabled,listeners:{specialkey:a.onSpecialKey,scope:a}});if(a.showForgottenPassword){b.push({xtype:'component',autoEl:{tag:'a',href:'#',html:'Forgot your password?'},listeners:{el:{click:a.onForgottenPasswordClick,scope:a}}})}a.items={xtype:'form',frame:!1,bodyBorder:!1,border:!1,hideBorders:!0,items:b,listeners:{validitychange:a.onFormValidityChange,scope:a}}},createButtons:function(){var a=this;a.buttons=[{text:'Change password',itemId:'changePasswordBtn',cls:'id-changePasswordBtn',hidden:!a.showPasswordChange,handler:a.onPasswordChangeClick,scope:a},{text:'Login',iconCls:'icon-key',cls:'id-loginBtn',itemId:'loginBtn',disabled:!0,handler:a.onLoginClick,scope:a}]},afterRender:function(){Ext.panel.Panel.prototype.afterRender.call(this);this.focus();this.down('#user').focus()},onFormValidityChange:function(b,a){this.down('#loginBtn').setDisabled(!a)},onSpecialKey:function(b,a){if(a.getKey()===a.ENTER){this.onLoginClick()}},onForgottenPasswordClick:function(c){c.preventDefault();var a=this,b=a.getForm();(a.eventController||a).fireEvent('forgottenpasswordclick',a,b.getValues())},onPasswordChangeClick:function(){var a=this,b=a.getForm();(a.eventController||a).fireEvent('passwordchangeclick',a,b.getValues())},onLoginClick:function(){var a=this,b=a.getForm();if(!b.isValid()){return}(a.eventController||a).fireEvent('login',a,b.getValues())},getUserField:function(){return this.down('#user')},getPasswordField:function(){return this.down('#password')},getForm:function(){return this.items.getAt(0)}},0,['WuisLoginForm'],['component','box','container','panel','WuisLoginForm'],{'component':!0,'box':!0,'container':!0,'panel':!0,'WuisLoginForm':!0},['widget.WuisLoginForm'],0,[WuisLogin.view,'LoginForm'],0);Ext.cmd.derive('WuisLogin.view.PasswordChange',Ext.window.Window,{cls:'wuislogin-passwordchange',layout:'fit',closable:!1,resizable:!1,modal:!0,constrain:!0,width:500,y:100,title:'Change Password',iconCls:'icon-key',passwordVtype:'wuisPassword',passwordValidator:null,eventController:null,headerHtml:null,validateMethod:'validator',passwordValidateTimerId:null,passwordErrors:null,initComponent:function(){var a=this;a.createItems();a.createButtons();Ext.window.Window.prototype.initComponent.apply(this,arguments)},createItems:function(){var a=this;var b=[];if(a.headerHtml){b.push({xtype:'box',cls:'login-header',padding:'15 15 0 15',html:a.headerHtml})}b.push({xtype:'box',dock:'left',itemId:'errorMsg',padding:'19 15 15 15',html:'',width:230});a.items={xtype:'form',border:0,bodyStyle:'border:0 none',bodyPadding:15,dockedItems:b,items:[{xtype:'textfield',labelAlign:'top',fieldLabel:'User Name',name:'user',itemId:'user',margin:'0 0 5 20',labelStyle:'margin-bottom:5px',anchor:'100%',allowBlank:!1,listeners:{specialkey:a.onSpecialKey,scope:a}},{xtype:'textfield',labelAlign:'top',fieldLabel:'Old Password',inputType:'password',name:'oldPassword',itemId:'oldPassword',margin:'0 0 5 20',labelStyle:'margin-bottom:5px',anchor:'100%',allowBlank:!1,listeners:{specialkey:a.onSpecialKey,scope:a}},{xtype:'textfield',labelAlign:'top',fieldLabel:'New Password',inputType:'password',name:'password1',itemId:'password1',margin:'0 0 5 20',labelStyle:'margin-bottom:5px',anchor:'100%',allowBlank:!1,vtype:a.passwordVtype,validator:a.validateMethod==='validator'?a.passwordValidator:null,listeners:{specialkey:a.onSpecialKey,change:a.onPassword1Change,errorchange:a.onPassword1ErrorChange,scope:a}},{xtype:'textfield',labelAlign:'top',fieldLabel:'New Password Again',inputType:'password',name:'password2',itemId:'password2',margin:'0 0 5 20',labelStyle:'margin-bottom:5px',anchor:'100%',allowBlank:!1,validator:function(a){return a===this.prev().getValue()?!0:'Passwords do not match!'},listeners:{specialkey:a.onSpecialKey,scope:a}},{xtype:'textfield',labelAlign:'top',fieldLabel:'\xa0',labelSeparator:'',margin:'0 0 5 20',labelStyle:'margin-bottom:5px',anchor:'100%',readOnly:!0,itemId:'pwStrength',value:'Password Strength',cls:'password-strength-field',validator:function(){return a.validateMethod!=='service'||!a.passwordErrors?!0:a.passwordErrors}}],listeners:{validitychange:a.onFormValidityChange,scope:a}}},createButtons:function(){var a=this;a.buttons=[{text:'Ok',itemId:'okBtn',cls:'id-okBtn',disabled:!0,handler:a.onPasswordChangeClick,scope:a},{text:'Cancel',itemId:'cancelBtn',cls:'id-cancelBtn',handler:a.onCancelClick,scope:a}]},afterRender:function(){var a=this;var b=a.getOldPasswordField();Ext.window.Window.prototype.afterRender.call(this);a.focus();if(b.getValue()){a.getPasswordField().focus()}else {b.focus()}},onFormValidityChange:function(b,a){this.down('#okBtn').setDisabled(!a)},onSpecialKey:function(b,a){if(a.getKey()===a.ENTER){this.doPasswordChange()}},onCancelClick:function(){var a=this;(a.eventController||a).fireEvent('passwordchangecancel',a,a.getForm().getValues())},onPasswordChangeClick:function(){this.doPasswordChange()},onPassword1Change:function(){var a=this;a.getForm().items.get('password2').isValid();if(a.validateMethod==='service'){if(a.passwordValidateTimerId){clearTimeout(a.passwordValidateTimerId)}a.passwordValidateTimerId=Ext.defer(a.firePasswordValidationEvent,500,a)}},firePasswordValidationEvent:function(){var a=this;(a.eventController||a).fireEvent('validatepassword',a,a.getForm().getValues())},onPassword1ErrorChange:function(c,e){var d=this;var b=!c.getValue();var a=this.getPwStrengthField();if(d.validateMethod==='service'){return}a.removeCls(['pw-ok','pw-error']);if(!b&&!e){a.addCls('pw-ok')}else {if(!b){a.addCls('pw-error')}}},getUserField:function(){return this.getForm().items.get('user')},getOldPasswordField:function(){return this.getForm().items.get('oldPassword')},getPasswordField:function(){return this.getForm().items.get('password1')},getPwStrengthField:function(){return this.getForm().items.get('pwStrength')},getErrorMsgBox:function(){return this.down('#errorMsg')},getForm:function(){return this.items.getAt(0)},doPasswordChange:function(){var a=this;var b=a.getForm();if(!b.isValid()){return}(a.eventController||a).fireEvent('passwordchange',a,b.getValues())}},0,['WuisLoginPasswordChange'],['component','box','container','panel','window','WuisLoginPasswordChange'],{'component':!0,'box':!0,'container':!0,'panel':!0,'window':!0,'WuisLoginPasswordChange':!0},['widget.WuisLoginPasswordChange'],0,[WuisLogin.view,'PasswordChange'],0);Ext.cmd.derive('WuisLogin.view.ResetPasswordForm',Ext.panel.Panel,{cls:'wuislogin-passwordchange',layout:'fit',closable:!1,resizable:!1,modal:!0,constrain:!0,width:360,title:'Change Password',iconCls:'icon-key',passwordVtype:'wuisPassword',passwordValidator:null,validateMethod:'validator',eventController:null,passwordValidateTimerId:null,passwordErrors:null,headerHtml:'<div style="font-size:14px;color:#194C7F;font-weight:bold">Change password</div><img src="resources/wuis-login/lsy-logo-small.png" style="width:250px;height:30px;margin-top:10px" />',initComponent:function(){var a=this;a.createItems();a.createButtons();Ext.panel.Panel.prototype.initComponent.apply(this,arguments)},createItems:function(){var a=this;a.items={xtype:'form',border:0,bodyStyle:'border:0 none',bodyPadding:15,dockedItems:[a.headerHtml?{xtype:'box',html:a.headerHtml}:null],defaults:{labelAlign:'top',minWidth:300,margin:'0 0 5 20'},items:[{xtype:'textfield',fieldLabel:'User Name',itemId:'user',name:'user',allowBlank:!1,listeners:{specialkey:a.onSpecialKey,scope:a}},{xtype:'textfield',fieldLabel:'New Password',inputType:'password',itemId:'password1',name:'password1',allowBlank:a.emptyPasswordEnabled,vtype:a.passwordVtype,validator:a.validateMethod==='validator'?a.passwordValidator:null,listeners:{specialkey:a.onSpecialKey,change:a.onPassword1Change,errorchange:a.onPassword1ErrorChange,scope:a}},{xtype:'textfield',fieldLabel:'New Password Again',inputType:'password',itemId:'password2',name:'password2',allowBlank:a.emptyPasswordEnabled,validator:function(a){return a===this.prev('#password1').getValue()?!0:'Passwords do not match!'},listeners:{specialkey:a.onSpecialKey,change:a.onPassword2Change,scope:a}},{xtype:'textfield',fieldLabel:'\xa0',labelSeparator:'',readOnly:!0,itemId:'pwStrength',value:'Password Strength',cls:'password-strength-field',validator:function(){return a.validateMethod!=='service'||!a.passwordErrors?!0:a.passwordErrors}},{xtype:'box',cls:'password-errors',itemId:'errorMsg',html:''}],listeners:{validitychange:a.onFormValidityChange,scope:a}}},createButtons:function(){var a=this;a.buttons=[{text:'Ok',itemId:'okBtn',cls:'id-okBtn',disabled:!0,handler:a.onPasswordChangeClick,scope:a},{text:'Cancel',itemId:'cancelBtn',cls:'id-cancelBtn',handler:a.onCancelClick,scope:a}]},afterRender:function(){Ext.panel.Panel.prototype.afterRender.call(this);this.focus()},updateButtonStatus:function(){var a=this;var b=a.getForm();var d=a.down('#okBtn');var c=b&&b.getForm();if(d&&c){d.setDisabled(!c.isValid()||a.validateMethod==='service'&&a.passwordValidateTimerId)}},onFormValidityChange:function(){this.updateButtonStatus()},onSpecialKey:function(b,a){if(a.getKey()===a.ENTER){this.doPasswordChange()}},onCancelClick:function(){var a=this;var b=a.down('form');(a.eventController||a).fireEvent('passwordchangecancel',a,b.getValues())},onPasswordChangeClick:function(){this.doPasswordChange()},onPassword1Change:function(){var a=this;a.getForm().items.get('password2').isValid();a.updateButtonStatus();if(a.validateMethod==='service'){if(a.passwordValidateTimerId){clearTimeout(a.passwordValidateTimerId);a.passwordValidateTimerId=null}a.passwordValidateTimerId=Ext.defer(a.firePasswordValidationEvent,500,a)}},firePasswordValidationEvent:function(){var a=this;a.passwordValidateTimerId=null;(a.eventController||a).fireEvent('validatepassword',a,a.getForm().getValues());a.updateButtonStatus()},onPassword2Change:function(){this.updateButtonStatus()},onPassword1ErrorChange:function(b,c){var e=this;var d=!b.getValue();var a=this.getPwStrengthField();if(e.validateMethod==='service'){return}a.removeCls(['pw-ok','pw-error']);if(d){a.setValue('Password Strength')}else {if(!c){a.addCls('pw-ok')}else {a.addCls('pw-error')}}},getForm:function(){return this.items.getAt(0)},getUserField:function(){return this.getForm().items.get('user')},getPasswordField:function(){return this.getForm().items.get('password1')},getPwStrengthField:function(){return this.getForm().items.get('pwStrength')},getErrorMsgBox:function(){return this.getForm().items.get('errorMsg')},doPasswordChange:function(){var a=this;var b=a.getForm();var c=a.down('#okBtn');if(!b||!c||c.isDisabled()||!b.isValid()){return}(a.eventController||a).fireEvent('passwordchange',a,b.getValues())}},0,['WuisLoginPasswordReset'],['component','box','container','panel','WuisLoginPasswordReset'],{'component':!0,'box':!0,'container':!0,'panel':!0,'WuisLoginPasswordReset':!0},['widget.WuisLoginPasswordReset'],0,[WuisLogin.view,'ResetPasswordForm'],0);